#theory #theory-sys_design
 
---
**–°–æ—Å—Ç–æ—è–Ω–∏–µ (State)** ‚Äî —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—É –∏–∑–º–µ–Ω—è—Ç—å —Å–≤–æ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –í–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ `if` –∏ `switch` –ª–æ–≥–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤—ã–Ω–æ—Å–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

–û—Ç–ª–∏—á–∏–µ –æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞ [–°—Ç—Ä–∞—Ç–µ–≥–∏—è (Strategy)](8.%20Patterns/–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ/–°—Ç—Ä–∞—Ç–µ–≥–∏—è%20(Strategy).md) –≤ —Ç–æ–º, —á—Ç–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –º—ã —Å–∞–º–∏ —É–ø—Ä–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞, –∞ –≤ State –æ–±—ä–µ–∫—Ç –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –≤—ã–±–æ—Ä –±–µ–∑ –Ω–∞—Å. Strategy –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏, –∞ State –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∞–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

üìå –ö–æ–≥–¥–∞ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è:  
- –ï—Å–ª–∏ —É –æ–±—ä–µ–∫—Ç–∞ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∏ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.  
- –ï—Å–ª–∏ –∫–æ–¥ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω —É—Å–ª–æ–≤–Ω—ã–º–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ (`if-else`, `switch-case`) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π.  
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —á—ë—Ç–∫–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ —Å–∞–º –æ–±—ä–µ–∫—Ç.

üìå –°—É—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–∞:  
–°–æ–∑–¥–∞—ë—Ç—Å—è –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å (–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å) –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –æ–±—â–∏–µ –º–µ—Ç–æ–¥—ã. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–∞–ª–∏–∑—É—é—Ç —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–π. –û–±—ä–µ–∫—Ç-–∫–æ–Ω—Ç–µ–∫—Å—Ç —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –µ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π.

üìå –í—ã–≥–æ–¥–∞:  
‚úîÔ∏è –£–±–∏—Ä–∞–µ—Ç –≥—Ä–æ–º–æ–∑–¥–∫–∏–µ —É—Å–ª–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏  
‚úîÔ∏è –£–ø—Ä–æ—â–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π  
‚úîÔ∏è –ò–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–∞—Ö  

---
#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –Ω–∞ C#:
–í —ç—Ç–æ–º –∫–æ–¥–µ `TrafficLight` –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`RedState`, `YellowState`, `GreenState`).

```csharp
// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
interface ITrafficLightState
{
    void Handle(TrafficLight context);
}

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –ö—Ä–∞—Å–Ω—ã–π —Å–≤–µ—Ç
class RedState : ITrafficLightState
{
    public void Handle(TrafficLight context)
    {
        Console.WriteLine("–ö—Ä–∞—Å–Ω—ã–π —Å–≤–µ—Ç üî¥. –ñ–¥–∏—Ç–µ.");
        context.SetState(new GreenState());
    }
}

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –ó–µ–ª—ë–Ω—ã–π —Å–≤–µ—Ç
class GreenState : ITrafficLightState
{
    public void Handle(TrafficLight context)
    {
        Console.WriteLine("–ó–µ–ª—ë–Ω—ã–π —Å–≤–µ—Ç üü¢. –ú–æ–∂–Ω–æ –∏–¥—Ç–∏.");
        context.SetState(new YellowState());
    }
}

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –ñ—ë–ª—Ç—ã–π —Å–≤–µ—Ç
class YellowState : ITrafficLightState
{
    public void Handle(TrafficLight context)
    {
        Console.WriteLine("–ñ—ë–ª—Ç—ã–π —Å–≤–µ—Ç üü°. –ì–æ—Ç–æ–≤—å—Ç–µ—Å—å.");
        context.SetState(new RedState());
    }
}

// –ö–æ–Ω—Ç–µ–∫—Å—Ç, —Ö—Ä–∞–Ω—è—â–∏–π —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
class TrafficLight
{
    private ITrafficLightState _state;

    public TrafficLight(ITrafficLightState state) => _state = state;

    public void SetState(ITrafficLightState state) => _state = state;

    public void Request() => _state.Handle(this);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
class Program
{
    static void Main()
    {
        TrafficLight light = new TrafficLight(new RedState());

        for (int i = 0; i < 5; i++)
        {
            light.Request();
            Thread.Sleep(1000);
        }
    }
}
````

### Outer links:
https://metanit.com/sharp/patterns/3.6.php