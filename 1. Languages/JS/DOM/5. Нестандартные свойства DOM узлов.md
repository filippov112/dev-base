#lang #lang-js 

# 5. Нестандартные свойства DOM узлов

**Узлы DOM-дерева – это объекты языка JavaScript.**

1. Мы можем добавлять в них свои собственные свойства через JS код:

   ```javascript
   let body = document.body;
   body.myStyle = "color: red";
   console.log(body.myStyle);
   
   body.myStyle = { // с объектами это также работает
       color: "red",
       fontSize: 20
   }
   ```

2. Можем прописывать свои методы тем же способом:

   ```javascript
   body.getFontSize = function() {
       return this.myStyle.fontSize;
   }
   console.log(body.getFontSize());
   ```

   Если какое-либо свойство уже существует и мы пытаемся его изменить, то оно либо изменится на другое, либо возникнет ошибка, если свойство неизменяемое.

3. Посмотреть список основных свойств объекта можно через вывод в `console.dir`:

   ```javascript
   console.dir(body);
   ```

4. Нестандартные свойства, записанные через теги, недоступны путем обращения к ним через точку:

   ```html
   <div id="comm" deflt="значение">Сообщения</div>
   ```

   ```javascript
   console.log(div.deflt); // undefined
   ```

   Для работы с такими нестандартными свойствами следует пользоваться следующими методами, так как все значения нестандартных атрибутов могут быть только строками. Даже если мы указываем какой-то другой тип данных, он автоматически будет приведен к строке.
   - `elem.hasAttribute(name)` – проверяет наличие атрибута;
   - `elem.getAttribute(name)` – получает значение атрибута;
   - `elem.setAttribute(name, value)` – устанавливает значение атрибута;
   - `elem.removeAttribute(name)` – удаляет атрибут.

   Пример использования:

   ```javascript
   console.log(div.getAttribute("deflt"));
   div.setAttribute("deflt", "новое значение");
   ```

5. Полный список указанных атрибутов в HTML-документе хранится в коллекции `attributes`:

   ```javascript
   for (let val of div.attributes) {
       console.log(val);
   }
   ```

### Возможности применения нестандартных атрибутов

1. В первом случае они могут помочь нам выбрать необходимые узлы DOM-дерева и прописать им заданные свойства:

   ```html
   <table>
       <tr>
           <td cell-red="#CC0000">1</td>
           <td cell-blue="#0000CC">2</td>
           <td cell-red="#CC0000">3</td>
           <td cell-blue="#0000CC">4</td>
       </tr>
       <tr>
           <td cell-blue="#0000CC">5</td>
           <td cell-red="#CC0000">6</td>
           <td cell-blue="#0000CC">7</td>
           <td cell-red="#CC0000">8</td>
       </tr>
   </table>
   ```

   Пример скрипта:

   ```javascript
   for (let cell of document.querySelectorAll('[cell-red]')) {
       let attr = cell.getAttribute('cell-red');
       cell.style.background = attr;
   }
   ```

2. Во втором случае мы можем использовать эти атрибуты в таблице стилей:

   ```html
   <style>
       td[cell-red="#CC0000"] {
           background: #CC0000;
       }
       td[cell-red="lightRed"] {
           background: #FF9999;
       }
   </style>
   ```

   Далее, через JavaScript мы можем управлять этими стилями:

   ```javascript
   let flSkip = false;
   for (let cell of document.querySelectorAll('[cell-red]')) {
       if (!flSkip) cell.setAttribute('cell-red', 'lightRed');
       flSkip = !flSkip;
   }
   ```

3. Принято создавать пользовательские атрибуты, давая им специальный префикс. Все атрибуты, начинающиеся с префикса `data-`, будут восприниматься как нестандартные:

   ```html
   <td data-cell-red="#CC0000">1</td>
   ```

   Все эти свойства с префиксом `data-` становятся доступными через специальную коллекцию `dataset`, которая имеется у всех DOM-элементов:

   ```javascript
   cell.dataset.cellRed = 'lightRed';
   ```

   При этом сам префикс `data-` опускается, и оставшееся имя записывается по следующему правилу:
   - Если свойство использует дефисы, то в `dataset` оно прописывается в верблюжьей нотации (например, `data-cell-red` → `cellRed`);
   - В остальных случаях просто используется оставшееся имя (например, `data-color` → `color`).
