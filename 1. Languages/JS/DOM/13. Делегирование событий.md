#lang #lang-js 

---
- Можно перехватывать однотипные события с помощью одного общего **группирующего обработчика**.

```html
<ul id="main_menu">
    <li>Открыть</li>
    <li>Сохранить</li>
    <li>Рисовать</li>
    <li>Редактировать</li>
    <li>Настройки</li>
</ul>
```

```javascript
main_menu.addEventListener("click", function(event) {
    let li = event.target.closest('li'); // перехватываем только элементы по названию тега (null – иначе)
    
    if (li == null) return; // останавливаем обработчик, если событие не подходит
    
    console.log(li.innerHTML);
});
```

- Можно **варьировать действия** общего обработчика в зависимости от конкретного события (выбор действия).

```html
<li data-command="open">Открыть</li>
<li data-command="save">Сохранить</li>
<li data-command="draw">Рисовать</li>
<li data-command="edit">Редактировать</li>
<li data-command="customize">Настройки</li>
```

```javascript
main_menu.addEventListener("click", function(event) {
    let li = event.target.closest('li');
    
    if (li == null) return;

    let menuActs = {
        open() { alert("open..."); },
        save() { alert("save..."); },
    };

    let act = li.dataset.command;

    if (act && menuActs[act] !== undefined) menuActs[act](); // выбираем функцию из нашего объекта menuActs
});
```

- С помощью пользовательских атрибутов (data-) можно реализовывать **общие обработчики** для разных полезных функций.

```html
<p><input type="button" data-toggle-id="main_menu" value="Показать/Скрыть меню" /></p>
```

```javascript
document.addEventListener("click", function(event) { // вешаем на весь документ целиком
    let id = event.target.dataset.toggleId;

    if (!id) return;

    let elem = document.getElementById(id); // ищем элемент, с которым собираемся взаимодействовать

    if (!elem) return;

    elem.hidden = !elem.hidden; // прячем найденный элемент
});
```

- Можно **прерывать действия** браузера на событие **по-умолчанию** (2 способа):
    1. `onclick="return false;"`
    2. `event.preventDefault();` - в обработчике

Остановимся на последнем. Например, можно вызывать пользовательские контекстные меню, отменяя при этом стандартное.

```javascript
document.oncontextmenu = function(event) {
    console.log("Контекстное меню главного меню");
    event.preventDefault();
}
```

- Имея несколько пользовательских однотипных обработчиков на разных уровнях сайта, можно **контролировать их вызов**, чтобы не вызывать все сразу.

Добавим первой строкой в `document.addEventListener`:

```javascript
if (event.defaultPrevented) return;
```

Благодаря свойству `event.defaultPrevented` мы можем узнать, **был ли** в дочерних элементах вызван метод `event.preventDefault();` и **если да**, то `defaultPrevented` принимает значение **true**.

- Можно указать браузеру выполнять обработчик **параллельно со стандартным** для устранения задержки при определенных задачах (к примеру, при скроллинге).

```javascript
document.addEventListener("contextmenu", function(event) {
    if (event.defaultPrevented) return;
    console.log("Контекстное меню документа");
}, {passive: true});
```

Так мы говорим браузеру, что **не будем прерывать стандартный** обработчик. Поэтому использование с таким параметром метода `preventDefault()` недопустимо и приводит к ошибке.
