#Python #sqlite

# Сохранение изображений

Создаем таблицу `users` для хранения пользователей и их аватаров:

```sql
CREATE TABLE IF NOT EXISTS users (
    name TEXT,
    ava BLOB,        -- тип BLOB используется для хранения изображений
    score INTEGER
)
```

Далее напишем вспомогательную функцию считывания изображения из файла:

```python
def readAva(n):
    try:
        with open(f"avas/{n}.png", "rb") as f:
            return f.read()
    except IOError as e:
        print(e)
        return False
```

Теперь считываем изображение и вставляем его в базу данных:

```python
img = readAva(1)
if img:
    binary = sq.Binary(img)        -- преобразуем бинарный код в объект sqlite
    cur.execute("INSERT INTO users VALUES ('Николай', ?, 1000)", (binary,))
```

Давайте теперь прочитаем изображение из этого поля. Выполним следующий запрос:

```sql
SELECT ava FROM users LIMIT 1
```

И с помощью метода `fetchone` обратимся к первой (и единственной) записи и возьмем данные из поля `ava`:

```python
img = cur.fetchone()['ava']  -- предварительно переводим курсор в объект типа Row 
                              -- для работы как с словарём
```

Если теперь записать этот код в файл, то получится изображение.
