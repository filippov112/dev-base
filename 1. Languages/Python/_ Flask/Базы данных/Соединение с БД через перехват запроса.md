#lang #lang-python  

# Соединение с БД через перехват запроса

```python
dbase = None

@app.before_request
def before_request():
    """
    Установление соединения с БД перед выполнением запроса
    """
    global dbase
    db = get_db()
    dbase = FDataBase(db)

def get_db():
    """
    Функция проверки наличия и установки соединения с БД для обработчиков
    """
    if not hasattr(g, 'link_db'):
        g.link_db = connect_db()
    return g.link_db

def connect_db():
    """
    Функция для установления соединения с БД
    """
    conn = sqlite3.connect(app.config['DATABASE'])
    conn.row_factory = sqlite3.Row
    return conn
```

### Описание

- **`before_request`** — устанавливает соединение с базой данных перед выполнением запроса.
- **`get_db`** — проверяет наличие активного соединения с базой данных и, если его нет, вызывает функцию подключения.
- **`connect_db`** — подключает к базе данных с использованием SQLite и устанавливает формат результата в виде строк.
