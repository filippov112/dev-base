#lang #lang-python 

# Мгновенные сообщения

**Функции:**
- `flash()` – формирование сообщения пользователю.
- `get_flashed_messages()` – обработка сформированных сообщений в шаблоне документа.

---

**Шаблон реализации:**
```python
flask.flash(message, category='message')
flask.get_flashed_messages(with_categories=False, category_filter=[])
```

**Атрибуты:**
- `message` – текст сообщения;
- `category` – категория сообщения;
- `with_categories` – разрешает использование категорий при извлечении сообщений;
- `category_filter` – список разрешенных категорий при выборке сообщений.

---

**Пример использования:**

Обычно мгновенные сообщения используются для взаимодействия с отправкой данных форм:
```python
if len(request.form['username']) > 2:
    flash('Сообщение отправлено', category='success')  # category - расширение класса
else:
    flash('Ошибка отправки', category='error')          # можно использовать при оформлении
```
*(необязательно: можно использовать таблицы стилей для разных типов сообщений)*

---

**Обращение шаблона к списку flash-уведомлений сессии и выборка всего их списка:**
```jinja
{% for cat, msg in get_flashed_messages(True) %}
    <div class="flash {{ cat }}">{{ msg }}</div>  # сначала передаётся категория, затем само сообщение
{% endfor %}
```
`True` - даёт разрешение на использование категории сообщений.

---

**Примечание:**
Список флэш-уведомлений сохраняется на протяжении **СЕССИИ**, а не **ЗАПРОСА**. Поэтому при повторной отправке формы первое уведомление не появится, а появится новое, сгенерированное обработчиком при отправке последнего запроса.

---

**Команда активации сессии для корректной работы программы:**
```python
app.config['SECRET_KEY'] = 'fdgdfgdfggf786hfg6hfg6h7f'  # ключ любой
```
Используется для шифровки куки-файлов, сохраняемых браузером.
