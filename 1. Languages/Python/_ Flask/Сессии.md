#lang #lang-python #flask

---
```python
app.config['SECRET_KEY'] = 'cb02820a3e94d72c9f950ee10ef7e3f7a35b3f5b'
```
- Задание ключа шифрования сессии.

```python
os.urandom(20).hex()  # Функция модуля os для случайной генерации ключа
```
---

```python
data = [1, 2, 3, 4]

@app.route("/session")
def session_data():
    if 'data' not in session:
        session['data'] = data
    else:
        session['data'][1] += 1
 
    return f"session['data']: {session['data']}"
```

---
Объект `session` в этом случае никак не меняется: он как ссылался на список,  
так и ссылается (адрес списка остается прежним). Меняется лишь элемент  
в самом списке, и это изменение не влияет на изменение `session`. А раз так,  
то Flask решает, что сессия не поменялась, и нет смысла нагружать канал связи  
и дополнительно её отправлять браузеру.

Но это можно поправить, прописав следующую строчку:

```python
session.modified = True
```
---
По умолчанию куки сессии существуют, пока пользователь не закроет браузер.  
Но это поведение можно изменить и явно указать время жизни сессий в куках.  
Для этого в функции представления нужно указать:

```python
session.permanent = True
```

Тогда время жизни сессии устанавливается равным параметру:

```python
app.permanent_session_lifetime
```

который по умолчанию составляет 31 день. Но можно определить любое другое значение, например, так:

```python
app.permanent_session_lifetime = datetime.timedelta(days=10)
```

Теперь сессии будут максимум храниться 10 дней в браузере клиента.
