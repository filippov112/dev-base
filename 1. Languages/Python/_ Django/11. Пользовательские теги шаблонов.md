 #lang #lang-python #django

---
> Django позволяет использовать два вида пользовательских тегов:
> - **simple tags** – простые теги;
> - **inclusion tags** – включающие теги.
> В каталоге приложения все теги хранятся по умолчанию в каталоге `templatetags` (с вложенным файлом `__init__.py` — пакет).
> 
> [Подробная документация](https://djbook.ru/rel3.0/howto/custom-template-tags.html)


#### 1. **Создание файла для хранения тегов**
Создаём файл для хранения тегов (далее `women_tags.py`):
```python
from django import template  # импортируем модуль для работы с шаблонами
from women.models import *    # импортируем модели приложения
```

#### 2. **Создаём экземпляр регистратора тегов**
```python
register = template.Library()
```

#### Передача параметров пользовательским тегам
Пример передачи параметров в теги:
```python
def get_categories(filter=None):
    # Вызов тега: {% getcats filter=1 %} или {% getcats 2 %}
```

---

## Simple Tags

#### 1. Определение функции и связывание с тегом

```python
@register.simple_tag()
def get_categories():
    return Category.objects.all()
```

> Примечание:  
> Тег можно именовать отличным от функции:

```python
@register.simple_tag(name='getcats')
```

#### 2. Подключение файла тегов к базовому шаблону

```django
{% load women_tags %}
```

#### 3. Использование тега в шаблоне через переменную

```django
{% get_categories as categories %}
```

---

## Inclusion Tags

**Inclusion Tags** — включающие теги, позволяют формировать свой собственный шаблон на основе некоторых данных и возвращать фрагмент HTML-страницы.

#### 1. Определение функции

```python
@register.inclusion_tag('women/list_categories.html')
def show_categories():
    cats = Category.objects.all()
    return {"cats": cats}
```

#### 2. Прописывание шаблона-вставки

```django
{% for c in categories %}
    {% if c.pk == cat_selected %}
        <li class="selected">{{ c.name }}</li>
    {% else %}
        <li><a href="{{ c.get_absolute_url }}">{{ c.name }}</a></li>
    {% endif %}
{% endfor %}
```

#### 3. Использование в шаблоне

```django
{% show_categories %}
```


