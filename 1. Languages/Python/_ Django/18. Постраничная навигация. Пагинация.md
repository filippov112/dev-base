#lang #lang-python #django

---
**Ссылки на англ источник:**  
[Примеры](https://docs.djangoproject.com/en/3.1/topics/pagination/)  
[API](https://docs.djangoproject.com/en/3.1/ref/paginator/)  

Как на сайте представлять длинные списки чего-либо.  
Предположим, имеется следующий список:

```python
women = [
    'Анджелина Джоли', 'Дженнифер Лоуренс', 'Джулия Робертс', 
    'Марго Робби', 'Ума Турман', 'Ариана Гранде', 
    'Бейонсе', 'Кэтти Перри', 'Рианна', 'Шакира'
]
```

И нам нужно выводить их постранично, допустим, по три имени на странице.

---

```python
from django.core.paginator import Paginator

p = Paginator(women, 3)  # указываем число объектов на странице
```

### Список доступных методов:

- `p.count`          # число элементов в списке
- `p.num_pages`     # число страниц (10:3 = 4 – округление до большего)
- `p.page_range`     # итератор для перебора номеров страниц

```python
p1 = p.page(1)  # получение первой страницы
p1.object_list      # список элементов текущей страницы
p1.has_next()      # имеется ли следующая страница
p1.has_previous()  # имеется ли предыдущая страница
p1.has_other_pages()  # имеются ли другие страницы
p1.next_page_number()  # номер следующей страницы
p1.previous_page_number()  # номер предыдущей страницы
```

---

### РЕАЛИЗАЦИЯ С ФУНКЦИЕЙ ПРЕДСТАВЛЕНИЯ

```python
contact_list = Women.objects.all()  # берем список объектов
paginator = Paginator(contact_list, 3)  # создаём пагинатор по списку
page_number = request.GET.get('page')  # берем из гет-запроса параметр страницы 'page'
page_obj = paginator.get_page(page_number)  # берем из пагинатора страницу по полученному через запрос номеру

return render(request, 'women/about.html', {'page_obj': page_obj, ........})
```
- отправляем страницу пагинатора в шаблон

---

### РЕАЛИЗАЦИЯ С КЛАССОМ ПРЕДСТАВЛЕНИЯ

```python
paginate_by = 3  # ...и всё.
```

---

### В ШАБЛОНЕ

Общий код как для функций, так и для классов (кроме *)  
Свойство `page_obj` стандартное для классов представлений.

```django
{% for contact in page_obj %}  # отображаем элементы страницы
    <p>{{ contact }}</p>
{% endfor %}
```

Отображаем список доступных страниц через `page_range`:

```django
{% if page_obj.has_previous %}  # при наличии предыдущей страницы отображаем ссылку на нее
    <a href="?page={{ page_obj.previous_page_number }}">&lt;</a>  # &lt; - угловая скобка
{% endif %}
```

---

```django
{% if page_obj.has_other_pages %}  # отображаем панель только при наличии более 1 страницы
    {% for p in page_obj.paginator.page_range %}  
        * - доступ к объекту пагинатора осуществляется через страницу,
          в отличие от работы с классом представления, где доступ происходит напрямую
          paginator.page_range

        {% if page_obj.number == p %}  # если номер текущей страницы совпадает с номером перебора,
            {{ p }}  # то отображаем как обычный текст
        {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2  %}  
            <a href="?page={{ p }}">{{ p }}</a>  
        {% endif %}
    {% endfor %}
{% endif %}
```

---

```django
{% if page_obj.has_next %}  # повторяем операцию для ссылки на следующую страницу
    <a href="?page={{ page_obj.next_page_number }}">&gt;</a>
{% endif %}
```
