#lang #lang-python 

# 4. Определение моделей

По умолчанию Django сконфигурирован для работы с БД SQLite.

`DATABASES` по умолчанию определяет СУБД SQLite3 и путь к файлу БД `db.sqlite3`.

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}
```

Подключение к другим СУБД происходит в этом же словаре `DATABASES`, главное, иметь драйвер взаимодействия с ними.

## Описание модели таблицы

Перейдем в файл `имя_приложения/models.py`. В начале уже импортирован пакет `models`, содержащий базовый класс `Model`, на базе которого и строятся модели:

```python
class Women(models.Model):
    title = models.CharField(max_length=255)
    content = models.TextField(blank=True)
    photo = models.ImageField(upload_to="photos/%Y/%m/%d/")  # требует модуль (pip install pillow)
    time_create = models.DateTimeField(auto_now_add=True)
    time_update = models.DateTimeField(auto_now=True)
    is_published = models.BooleanField(default=True)
```

Похоже на описание таблиц из SQLAlchemy (см. Flask). [Ссылка на документацию](https://djbook.ru/rel3.0/).

Нигде нет поля `id`, такое поле создается автоматически у каждой таблицы. Оно уже прописано в базовом классе `Model`.

### Краткое описание
- `blank=True` - означает, что поле может быть пустым.
- `upload_to="photos/%Y/%m/%d/"` - определяет имя папки на сервере, в которую будут сохраняться изображения, в виде шаблона по дате для удобного поиска. `photo` будет содержать полный путь к файлу изображения.
- `auto_now_add` - фиксаторы времени добавления записи.
- `auto_now` - фиксаторы времени изменения записи.

## Настройка для поля `ImageField`

В пакете конфигурации открываем файл `settings.py` и в конце допишем эти константы:

```python
MEDIA_ROOT = os.path.join(BASE_DIR, 'media')  # MEDIA_ROOT будет ссылаться на папку media, расположенной в текущем рабочем каталоге проекта
MEDIA_URL = '/media/'  # будет добавлять к URL графических файлов префикс media.
```

В процессе отладки сайта нужно сэмулировать работу реального сервера для получения ранее загруженных файлов и передачи их нашему приложению. В файл `urls.py` пакета конфигурации и добавим такую строчку:

```python
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```
