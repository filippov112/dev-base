#ML

# Автоэнкодеры

**Автоэнкодер** – это нейронная сеть, которая сначала кодирует входной сигнал в некоторое скрытое состояние, размерность которого, как правило, меньше размерности входного сигнала, а затем, из скрытого состояния снова разворачивает (декодирует) данные в другое, новое состояние.

### Примеры применения

Размерности входных и выходных векторов, в общем случае, могут отличаться. 
- Например, можно попробовать обучить автоэнкодер масштабировать изображения.
- В другом примере, сжатия данных, декодер должен как можно точнее воспроизвести входное изображение, опираясь только на вектор скрытого состояния (неэффективно по сравнению с алгоритмами).

---

### Реализация автоэнкодера

Реализуем относительно простой автоэнкодер в виде многосвязной нейронной сети для представления изображений цифр из базы данных MNIST, с которой ранее мы уже работали.

#### Архитектура автоэнкодера:

```python
input_img = Input((28, 28, 1))
x = Flatten()(input_img)
x = Dense(128, activation='relu')(x)
x = Dense(64, activation='relu')(x)
encoded = Dense(49, activation='relu')(x)  # вектор скрытого состояния состоит из максимально сжатых данных (здесь 49 значений)

d = Dense(64, activation='relu')(encoded)
d = Dense(28*28, activation='sigmoid')(d)
decoded = Reshape((28, 28, 1))(d)  # на выходе автоэнкодера мы хотим получить изображение максимально приближенное к исходному

autoencoder = keras.Model(input_img, decoded, name="autoencoder")
autoencoder.compile(optimizer='adam', loss='mean_squared_error')
autoencoder.fit(x_train, x_train, epochs=20, batch_size=batch_size, shuffle=True)
```

![Результат работы|700|center](heap/_files/25.1.%20Результат%20работы%20автоэнкодера.png)

![Суть работы|700|center](heap/_files/25.2.%20Суть%20работы%20автоэнкодера.png)