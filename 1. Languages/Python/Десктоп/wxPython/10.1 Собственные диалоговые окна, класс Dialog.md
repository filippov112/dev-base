#lang #lang-python 

# 10.1 Собственные диалоговые окна, класс Dialog

Все диалоговые окна наследуются от класса `Dialog`, имеющий следующий синтаксис:

```python
wx.Dialog(parent, id=ID_ANY, title="", pos=DefaultPosition, size=DefaultSize, 
          style=DEFAULT_DIALOG_STYLE, name=DialogNameStr)
```

- **parent** – ссылка на родительское окно (или значение `None`);
- **id** – идентификатор окна;
- **title** – заголовок окна;
- **pos**, **size** – позиция и размер окна;
- **style** – стилизация окна.

> См. [wx.Dialog documentation](https://docs.wxpython.org/wx.Dialog.html)

---

### Флаги для настройки `style`

- `wx.CAPTION` – разрешает заголовок окна;
- `wx.DEFAULT_DIALOG_STYLE` (комбинация констант: `wx.CAPTION`, `wx.CLOSE_BOX` и `wx.SYSTEM_MENU`);
- `wx.RESIZE_BORDER` – разрешает изменять размеры окна;
- `wx.SYSTEM_MENU` – для отображения системного меню;
- `wx.CLOSE_BOX` – для отображения кнопки закрытия (с крестиком);
- `wx.MAXIMIZE_BOX` – для возможности распахивания окна;
- `wx.MINIMIZE_BOX` – для возможности свертывания окна;
- `wx.STAY_ON_TOP` – для отображения окна поверх всех остальных.

---

### Создание своего диалогового окна

Создадим свое диалоговое окно, объявим класс `MyDlg`, который унаследуем от `Dialog`:

```python
class MyDlg(wx.Dialog):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
```

---

### Взаимодействие с экземпляром в обработчике фрейма

```python
def onDialog(self, e):
    dlg = MyDlg(self, title="Мой диалог...")
    res = dlg.ShowModal()  # отображаем модальное окно.
    dlg.Destroy()          # удаляем экземпляр диалогового окна из памяти
    print(res)             # выводим возвращенные окном данные
```

При закрытии диалогового окна функция `ShowModal` возвратит id константы `wx.ID_CANCEL`.

---

### Модальные и немодальные окна

**Модальные** – замораживающие выполнение других окон в момент своего вызова. Для модальных окон создается свой независимый цикл обработки событий.

Так в примерах предыдущего урока всегда использовалась функция `ShowModal()`, которая вызывала модальное окно.

```python
def onDialog(self, e):
    dlg = MyDlg(self, title="Мой диалог...")
    res = dlg.Show()  # если вместо модального мы отобразим обычное окно, то 
                      # цикл фрейма продолжит выполняться и сразу закроет это окно,
    dlg.Destroy()     # вызвав метод Destroy()
    print(res)
```

Поскольку при использовании `Show` не создается дочернего цикла обработки событий, это дает возможность открывать сразу несколько окон.

---

### Удаление экземпляров окон

Экземпляры окон следует всегда удалять из памяти после закрытия с помощью `Destroy()` для предотвращения зависания их в памяти в случае ошибки.

Сделать это можно через `try-finally`, прописав всё вручную, либо создать экземпляр окна через менеджер контекста (в этом случае `__exit__` выполнит `Destroy()` за нас).

```python
with MyDlg(self, title="Мой диалог...") as dlg:
    res = dlg.ShowModal()
    print(res)
```

---

### Контроль возвращаемых значений

1. **Ручное задание возв. значения**

```python
bOk.Bind(wx.EVT_BUTTON, self.onOk)

def onOk(self, event): 
    self.EndModal(wx.ID_OK)  # завершает цикл выполнения диалогового окна 
                              # и определяет возвращаемое значение в виде 
                              # константы ID_OK
```

2. **Через определение стандартных id при инициализации виджетов**

```python
bOk = wx.Button(self, wx.ID_OK, label="Да", size=(100, 30))
```
