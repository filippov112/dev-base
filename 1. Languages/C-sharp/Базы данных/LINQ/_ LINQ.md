 #Csharp 

# LINQ в C#

**LINQ (Language Integrated Query)** - это набор технологий в C#, позволяющих выполнять запросы к данным из различных источников.
Основная часть функциональности LINQ сосредоточена в пространстве имен `System.LINQ`.
В качестве источника данных может выступать объект, реализующий интерфейс `IEnumerable`.

Существует несколько разновидностей LINQ:
- *LINQ to Objects*: применяется для работы с массивами и коллекциями
- *LINQ to Entities*: используется при обращении к базам данных через технологию *Entity Framework*
- *LINQ to XML*: применяется при работе с файлами *XML*
- *LINQ to DataSet*: применяется при работе с объектом *DataSet*
- *Parallel LINQ (PLINQ)*: используется для выполнения параллельных запросов

### Синтаксис:
2 варианта использования
- **Методы расширения (основной):** 
```csharp
string[] people = { "Tom", "Bob", "Sam", "Tim", "Tomas", "Bill" };
 
var selectedPeople = people.Where(p => p.ToUpper().StartsWith("T")).OrderBy(p => p);
 
foreach (string person in selectedPeople)
    Console.WriteLine(person);
```

- **Операторы запросов:** 
```csharp
// from переменная in набор_объектов select переменная;

string[] people = { "Tom", "Bob", "Sam", "Tim", "Tomas", "Bill" };
 
// создаем новый список для результатов
var selectedPeople = from p in people // передаем каждый элемент из people в переменную p
                    where p.ToUpper().StartsWith("T") //фильтрация по критерию
                    orderby p  // упорядочиваем по возрастанию
                    select p; // выбираем объект в создаваемую коллекцию
 
foreach (string person in selectedPeople)
    Console.WriteLine(person);
```

### Методы расширения:

- `Select` - определяет проекцию выбранных значений
- `Where` - определяет фильтр выборки
- `OrderBy` - упорядочивает элементы по возрастанию
- `OrderByDescending` - упорядочивает элементы по убыванию
- `ThenBy` - задает дополнительные критерии для упорядочивания элементов возрастанию
- `ThenByDescending` - задает дополнительные критерии для упорядочивания элементов по убыванию
- `Join` - соединяет две коллекции по определенному признаку
- `Aggregate` - применяет к элементам последовательности агрегатную функцию, которая сводит их к одному объекту
- `GroupBy` - группирует элементы по ключу
- `ToLookup` - группирует элементы по ключу, при этом все элементы добавляются в словарь
- `GroupJoin` - выполняет одновременно соединение коллекций и группировку элементов по ключу
- `Reverse` - располагает элементы в обратном порядке
- `All` - определяет, все ли элементы коллекции удовлятворяют определенному условию
- `Any` - определяет, удовлетворяет хотя бы один элемент коллекции определенному условию
- `Contains` - определяет, содержит ли коллекция определенный элемент
- `Distinct` - удаляет дублирующиеся элементы из коллекции
- `Except` - возвращает разность двух коллекцию, то есть те элементы, которые создаются только в одной коллекции
- `Union` - объединяет две однородные коллекции
- `Intersect` - возвращает пересечение двух коллекций, то есть те элементы, которые встречаются в обоих коллекциях
- `Count` - подсчитывает количество элементов коллекции, которые удовлетворяют определенному условию
- `Sum` - подсчитывает сумму числовых значений в коллекции
- `Average` - подсчитывает cреднее значение числовых значений в коллекции
- `Min` - находит минимальное значение
- `Max` - находит максимальное значение
- `Take` - выбирает определенное количество элементов
- `Skip` - пропускает определенное количество элементов
- `TakeWhile` - возвращает цепочку элементов последовательности, до тех пор, пока условие истинно
- `SkipWhile` - пропускает элементы в последовательности, пока они удовлетворяют заданному условию, и затем возвращает оставшиеся элементы
- `Concat` - объединяет две коллекции
- `Zip` - объединяет две коллекции в соответствии с определенным условием
- `First` - выбирает первый элемент коллекции
- `FirstOrDefault` - выбирает первый элемент коллекции или возвращает значение по умолчанию
- `Single` - выбирает единственный элемент коллекции, если коллекция содержит больше или меньше одного элемента, то генерируется исключение
- `SingleOrDefault` - выбирает единственный элемент коллекции. Если коллекция пуста, возвращает значение по умолчанию. Если в коллекции больше одного элемента, генерирует исключение
- `ElementAt` - выбирает элемент последовательности по определенному индексу
- `ElementAtOrDefault` - выбирает элемент коллекции по определенному индексу или возвращает значение по умолчанию, если индекс вне допустимого диапазона
- `Last` - выбирает последний элемент коллекции
- `LastOrDefault` - выбирает последний элемент коллекции или возвращает значение по умолчанию

### Outer links:
- [https://learn.microsoft.com/en-us/dotnet/csharp/linq/](https://learn.microsoft.com/en-us/dotnet/csharp/linq/)
- https://metanit.com/sharp/tutorial/15.1.php