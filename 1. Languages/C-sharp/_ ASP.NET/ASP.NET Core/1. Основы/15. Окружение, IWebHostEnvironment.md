#lang #lang-c_sharp 

# 15. Окружение, IWebHostEnvironment в ASP.NET Core

Для взаимодействия с окружением, в котором запущено приложение, фреймфорк ASP.NET Core предоставляет встроенный сервис `IWebHostEnvironment`. 
[1. Внедрение зависимостей. Сервисы](1.%20Languages/C-sharp/_%20ASP.NET/ASP.NET%20Core/2.%20DI/1.%20Внедрение%20зависимостей.%20Сервисы.md)

**Свойства `IWebHostEnvironment`:**
- `ApplicationName`: хранит имя приложения
- `EnvironmentName`: хранит название среды, в которой хостируется приложение
- `ContentRootPath`: хранит путь к корневой папке приложения
- `WebRootPath`: хранит путь к папке, в которой хранится статический контент приложения. По умолчанию это папка wwwroot
- `ContentRootFileProvider`: возвращает реализацию интерфейса `Microsoft.AspNetCore.FileProviders.IFileProvider`, которая может использоваться для чтения файлов из папки `ContentRootPath`
- `WebRootFileProvider`: возвращает реализацию интерфейса `Microsoft.AspNetCore.FileProviders.IFileProvider`, которая может использоваться для чтения файлов из папки `WebRootPath`

---

#### EnvironmentName

По умолчанию имеются 3 варианта значений для этого свойства: *Development, Staging и Production*. Но можно задать любое свое значение.
В проекте это свойство задается через установку переменной среды `ASPNETCORE_ENVIRONMENT` в файле *launchSettings.json* в папке `Properties` (можно устанавливать как в ручную, так и программно).

**Методы расширения:**
доступны через свойство `Environment` объекта приложения `WebApplication`:

- `IsEnvironment(string envName)`: возвращает `true`, если имя среды равно значению параметра envName
- `IsDevelopment()`: возвращает `true`, если имя среды - Development
- `IsStaging()`: возвращает `true`, если имя среды - Staging
- `IsProduction()`: возвращает `true`, если имя среды - Production

```csharp
var builder = WebApplication.CreateBuilder();
WebApplication app = builder.Build();
 
if (app.Environment.IsDevelopment())
{
    app.Run(async (context) => await context.Response.WriteAsync("In Development Stage"));
}
else
{
    app.Run(async (context) => await context.Response.WriteAsync("In Production Stage"));
}
Console.WriteLine($"{app.Environment.EnvironmentName}");
 
app.Run();
```

```csharp
if (context.HostingEnvironment.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
}
```

```csharp
var builder = WebApplication.CreateBuilder();
WebApplication app = builder.Build();
 
app.Environment.EnvironmentName = "Production";
```

### Outer links:
https://metanit.com/sharp/aspnet6/2.17.php