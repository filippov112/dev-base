#lang #lang-c_sharp #aspnet

---
**Сессия** - ряд последовательных запросов, совершенных в одном браузере в течение некоторого времени. 
*Данные сессии* должны быть доступны, пока пользователь работает с приложением, и не требовать постоянного хранения.

*Сервер:* словарь в кэше.
*Клиент:* идентификатор сессии в куках, отправляемый с запросами. 
- Куки очищаются после завершения сессии. 
- Если сервер получает куки, которые установлены уже для истекшей сессии, то для этих кук создается новая сессия.
- Сессия сохраняется некоторое время после последнего запроса (20 мин. по ум.).

Интерфейс кэша - `IDistributedCache`.
Реализация сессии - `HttpContext.Session`, интерфейс `ISession`.
Подключение компонента - `app.UseSession()`.

```csharp
var builder = WebApplication.CreateBuilder();
 
builder.Services.AddDistributedMemoryCache();// добавляем IDistributedMemoryCache
builder.Services.AddSession();  // добавляем сервисы сессии
 
var app = builder.Build();
 
app.UseSession();   // добавляем middleware для работы с сессиями
 
app.Run(async (context) =>
{
    if (context.Session.Keys.Contains("name")) // после UseSession можем обращаться к context.Session
        await context.Response.WriteAsync($"Hello {context.Session.GetString("name")}!");
    else
    {
        context.Session.SetString("name", "Tom");
        await context.Response.WriteAsync("Hello World!");
    }
});
 
app.Run();
```

### Outer links:
https://metanit.com/sharp/aspnet6/8.3.php