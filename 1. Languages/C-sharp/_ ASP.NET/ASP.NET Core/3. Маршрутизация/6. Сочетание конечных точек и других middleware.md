#lang #lang-c_sharp #aspnet

---
![|400](heap/_files/Pasted%20image%2020241117121528.png)

В конвейере обработки запросов все конечные точки расположены в самом низу. Т.е. сначала выполняются все middleware, затем выполняется выбранная для маршрута конечная точка, и в конце обработка проходит снова по всем middleware-ам в обратном порядке.

- В middleware-ах можно узнать какая точка выбрана для маршрута через `HttpContext.GetEndpoint()`.
- В зависимости от порядка действий в middleware (до или после `await next.Invoke();`) мы можем выполнять пред- или пост- обработку запроса.
- Терминальные компоненты, как следует из порядка обработки, блокируют движение запроса к конечным точкам, заканчивая цепочку на себе.

### Outer links:
https://metanit.com/sharp/aspnet6/3.7.php