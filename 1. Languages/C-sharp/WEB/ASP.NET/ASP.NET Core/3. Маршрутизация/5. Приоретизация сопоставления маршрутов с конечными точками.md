#Csharp #ASP

# 5. Приоретизация сопоставления маршрутов с конечными точками в ASP.NET Core

**АЛГОРИТМ МАРШРУТИЗАТОРА**
1. Сначала выбираются все конечные точки, шаблон маршрута которых совпадает с путем запроса.
2. Далее удаляются те, которые не соответствуют ограничениям маршрута.
3. Затем удаляются те, которые не удавлетворяют политике объекта *MatcherPolicy* (вкратце: класс *MatcherPolicy* позволяет определить порядок сравнения конечных точек и адреса URL)
4. И в самом конце применяется объект *EndpointSelector* для выбора из полученного на предыдущем этапе списка конечной точки, которая в конечном счете и будет обрабатывать запрос

**Факторы приоретизации:**
- Порядок следования в наборе конечных точек
- *Приоритетность* шаблона маршрута

*Приоритетность* шаблонов маршрута зависит от *специфичности* шаблона. 
**Критерии специфичности шаблонов:**
- Большее число сегментов **>** меньшее число сегментов
- Сегмент с текстовым литералом (статический сегмент) **>** сегмент с параметром маршрута
- Сегмент с параметром, к которому применяется ограничение маршрута **>** сегмент с параметром без ограничения
- Комплексный сегмент **>** сегмент с параметром с ограничением
- Параметр *catch-all* (параметр, который соответствует неопределенному количеству сегментов) наименее специфичен

### Outer links:
https://metanit.com/sharp/aspnet6/3.6.php