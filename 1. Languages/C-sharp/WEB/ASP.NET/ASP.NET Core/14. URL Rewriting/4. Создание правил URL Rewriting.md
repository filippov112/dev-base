#Csharp #ASP 
# <font color="#00b0f0">ASP.NET:</font> –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª URL Rewriting


### üìå –ö–æ–≥–¥–∞ –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–º–µ–Ω—è—Ç—å?

–í ASP.NET Core —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª URL Rewriting:

1. **–ì–æ—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã `RewriteOptions`** [1. URL Rewriting](1.%20Languages/C-sharp/WEB/ASP.NET/ASP.NET%20Core/14.%20URL%20Rewriting/1.%20URL%20Rewriting.md)
    - `AddRedirect()` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç (–∏–∑–º–µ–Ω–µ–Ω–∏–µ URL —Å –æ—Ç–≤–µ—Ç–æ–º 3xx). 
    - `AddRewrite()` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å URL –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞).    
    - `AddRedirectToHttps()` ‚Äî –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ HTTP ‚Üí HTTPS.     
    - `AddApacheModRewrite()` / `AddIISUrlRewrite()` ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞ Apache/IIS. [2. –ü—Ä–∞–≤–∏–ª–∞ IIS –¥–ª—è URL Rewriting](1.%20Languages/C-sharp/WEB/ASP.NET/ASP.NET%20Core/14.%20URL%20Rewriting/2.%20–ü—Ä–∞–≤–∏–ª–∞%20IIS%20–¥–ª—è%20URL%20Rewriting.md), [3. –ü—Ä–∞–≤–∏–ª–∞ Apache –¥–ª—è URL Rewriting](1.%20Languages/C-sharp/WEB/ASP.NET/ASP.NET%20Core/14.%20URL%20Rewriting/3.%20–ü—Ä–∞–≤–∏–ª–∞%20Apache%20–¥–ª—è%20URL%20Rewriting.md)
	---  
2. **–ß–µ—Ä–µ–∑ `Action<RewriteContext>`** ‚Äî –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª.
3. **–ß–µ—Ä–µ–∑ `IRule`** ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–ª–æ–∂–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∑–∞–ø—Ä–æ—Å–∞.
 

---

### üõ† –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —á–µ—Ä–µ–∑ `Action<RewriteContext>`

üìå **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**  
–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∑–∞–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ (–ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ç. –¥.).

```csharp
using Microsoft.AspNetCore.Rewrite;

var options = new RewriteOptions();

options.Add(context =>
{
    var request = context.HttpContext.Request;

    // –ï—Å–ª–∏ URL —Å–æ–¥–µ—Ä–∂–∏—Ç "old-page", –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ "new-page"
    if (request.Path.Value.Contains("old-page"))
    {
        context.HttpContext.Response.Redirect("/new-page", true);
        context.Result = RuleResult.EndResponse;
    }
});

app.UseRewriter(options);
```
---

### ‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ —á–µ—Ä–µ–∑ `IRule`

üìå **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**  
–ö–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, IP-–∞–¥—Ä–µ—Å–æ–≤, —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç. –¥.).

```csharp
using Microsoft.AspNetCore.Rewrite;
using Microsoft.AspNetCore.Http;

public class CustomRewriteRule : IRule
{
    public void ApplyRule(RewriteContext context)
    {
        var request = context.HttpContext.Request;

        if (request.Path.Value.StartsWith("/old-section"))
        {
            var newPath = request.Path.Value.Replace("/old-section", "/new-section");
            context.HttpContext.Response.Redirect(newPath, true);
            context.Result = RuleResult.EndResponse;
        }
    }
}
```

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ `Program.cs`:
```csharp
var options = new RewriteOptions();
options.Add(new CustomRewriteRule());

app.UseRewriter(options);
```
---
### Outer links:
https://metanit.com/sharp/aspnet6/15.4.php