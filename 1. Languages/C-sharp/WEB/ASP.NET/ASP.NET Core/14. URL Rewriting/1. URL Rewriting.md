#Csharp #ASP 
# <font color="#00b0f0">ASP.NET:</font> URL Rewriting

**URL Rewriting** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–≥–æ URL –ø–µ—Ä–µ–¥ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–µ—Ä–≤–µ—Ä–æ–º. 
–≠—Ç–æ –Ω–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç: –±—Ä–∞—É–∑–µ—Ä –Ω–µ —É–∑–Ω–∞—ë—Ç –æ –∑–∞–º–µ–Ω–µ, –∞ –∑–∞–ø—Ä–æ—Å –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–º—É –ø—É—Ç–∏.

–ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- –°–æ–∫—Ä—ã—Ç–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö URL (legacy).
- –£–ø—Ä–æ—â–µ–Ω–∏–µ URL –¥–ª—è SEO.
- –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Å–ª–µ—à–∞, HTTPS –∏ —Ç.–¥.).

---
### üß© –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ URL Rewriting

```csharp
using Microsoft.AspNetCore.Rewrite;

var app = builder.Build();

var options = new RewriteOptions()
    // –∑–¥–µ—Å—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞
;

app.UseRewriter(options);
```

---

### ‚öôÔ∏è RewriteOptions –∏ –µ–≥–æ –º–µ—Ç–æ–¥—ã
–ö–ª–∞—Å—Å `RewriteOptions` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª.

- `AddRedirect(string regex, string replacement)` ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ —à–∞–±–ª–æ–Ω—É (–∫–æ–¥ 302).
- `AddRedirect(string regex, string replacement, int statusCode)` ‚Äî —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–¥–æ–º.
- `AddRewrite(string regex, string replacement, bool skipRemainingRules)` ‚Äî –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç URL (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ, –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞).
- `Add(IRule rule)` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ (`IRule`).
- `AddApacheModRewrite(StreamReader reader)` ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `.htaccess`.
- `AddIISUrlRewrite(StreamReader reader)` ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `web.config`.

---

### üîç –ü—Ä–∏–º–µ—Ä—ã —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏

**–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å HTTP –Ω–∞ HTTPS**:
```csharp
options.AddRedirectToHttps(); // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç regex
```

**–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ URL –Ω–∞ –Ω–æ–≤—ã–π**:
```csharp
options.AddRedirect("^old-path$", "new-path");
```

**–£–¥–∞–ª–µ–Ω–∏–µ www. –∏–∑ URL**:
```csharp
options.AddRedirect("^www\\.(.*)", "https://$1");
```

**–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ URL –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç)**:
```csharp
options.AddRewrite("^products/(.*)", "catalog/item?id=$1", skipRemainingRules: true);
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∞–≤–∏–ª –∏–∑ IIS web.config**:
```csharp
using (var reader = File.OpenText("IISUrlRewrite.xml"))
{
    options.AddIISUrlRewrite(reader);
}
```

### Outer links:
https://metanit.com/sharp/aspnet6/15.1.php