#Csharp #ASP

# 3. JSON, XML, INI - конфигурации в ASP.NET Core

---
### **JSON**
Провайдер - `JsonConfigurationProvider`.
Метод - `AddJsonFile()`.

```json
{
  "person": {"profile": {"name": "Tomas", "email":  "tom@gmail.com"}},
  "company": { "name": "Microsoft"}
}
```

- Можно подключать сразу несколько файлов (одинаковые параметры будут перезаписаны).
- Ключи в файле должны быть уникальные.
- Обращение к вложенным структурам происходит через `:` 

```csharp
var builder = WebApplication.CreateBuilder();
var app = builder.Build();
 
builder.Configuration
                .AddJsonFile("config.json")
                .AddJsonFile("otherconfig.json");
 
app.Map("/", (IConfiguration appConfig) =>
{
    var personName = appConfig["person:profile:name"];
    var companyName = appConfig["company:name"];
    return $"{personName} - {companyName}";
});
 
app.Run();
```

---
### **XML**
Провайдер - `XmlConfigurationProvider`.
Метод - `AddXmlFile()`.

- У файла xml в свойствах должно быть выставлено копирование при компиляции в выходную папку приложения.
```xml
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <person>
      <profile>
          <name>Tomas</name>
          <email>toma@gmail.com</email>
      </profile>
  </person>
  <company>
      <name>Microsoft</name>
  </company>
</configuration>
```

```csharp
var builder = WebApplication.CreateBuilder();
var app = builder.Build();
 
builder.Configuration.AddXmlFile("config.xml");
 
app.Map("/", (IConfiguration appConfig) =>
{
    var personName = appConfig["person:profile:name"];
    var companyName = appConfig["company:name"];
    return $"{personName} - {companyName}";
});

app.Run();
```

---
### **INI**
Провайдер - `IniConfigurationProvider`.
Метод - `AddIniFile()`.

```ini
person="Bob"
company="Microsoft"
```

```csharp
var builder = WebApplication.CreateBuilder();
var app = builder.Build();
 
builder.Configuration.AddIniFile("config.ini");
 
app.Map("/", (IConfiguration appConfig) => $"{appConfig["person"]} - {appConfig["company"]}");
 
app.Run();
```

### Outer links:
https://metanit.com/sharp/aspnet6/6.3.php