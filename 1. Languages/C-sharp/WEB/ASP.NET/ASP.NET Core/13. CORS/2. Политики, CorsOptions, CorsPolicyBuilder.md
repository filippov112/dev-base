#Csharp #ASP 
# <font color="#00b0f0">ASP.NET:</font> ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ CORS

**ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÐ° CORS** â€” ÑÑ‚Ð¾ Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾, Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÑŽÑ‰ÐµÐµ, ÐºÐ°ÐºÐ¸Ðµ ÐºÑ€Ð¾ÑÑ-Ð´Ð¾Ð¼ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ñ‹. 
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº API Ð¸Ð· Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð´Ð¾Ð¼ÐµÐ½Ð¾Ð² (frontend-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹, Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² Ð¸ Ñ‚.Ð¿.).
ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚:
- ÑÐ²Ð½Ð¾ Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°Ñ‚ÑŒ Ð¸Ð»Ð¸ Ð·Ð°Ð¿Ñ€ÐµÑ‰Ð°Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ð¿Ð¾ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ°Ð¼, Ð¼ÐµÑ‚Ð¾Ð´Ð°Ð¼, Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ°Ð¼
- Ð·Ð°Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð´Ð»Ñ Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
- Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼ Ñ‡ÐµÑ€ÐµÐ· _CorsOptions_

ðŸ“Œ ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÑƒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒ:
- Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾ Ñ‡ÐµÑ€ÐµÐ· `app.UseCors(...)`
- Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ endpoint: `app.MapGet(...).RequireCors("FrontendPolicy")`
- Ñ‡ÐµÑ€ÐµÐ· Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚ `[EnableCors("FrontendPolicy")]` (Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð²)

---
### âš™ï¸ `CorsOptions`

**`CorsOptions`** â€” Ð¾Ð±ÑŠÐµÐºÑ‚ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸, Ñ‡ÐµÑ€ÐµÐ· ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸.
ÐšÐ°Ð¶Ð´Ð°Ñ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¸Ð¼ÐµÐµÑ‚ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¸Ð¼Ñ Ð¸ ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· `CorsPolicyBuilder`.

```csharp
builder.Services.AddCors(options =>
{
    // options â€” ÑÑ‚Ð¾ CorsOptions
    options.AddPolicy("MyPolicy", policy => {
        // policy â€” ÑÑ‚Ð¾ CorsPolicyBuilder
        policy.WithOrigins("http://localhost:3000")
              .WithMethods("GET", "POST")
              .WithHeaders("Content-Type")
              .AllowCredentials();
    });
});
```

---
### ðŸ§± `CorsPolicyBuilder`

**`CorsPolicyBuilder`** â€” Ð²ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÐºÐ»Ð°ÑÑ Ð´Ð»Ñ Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ CORS-Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸. 
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² `AddCors()` Ð¿Ñ€Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸.

ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð´Ð»Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ñ…:
- Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² (`WithOrigins`)
- Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð² (`WithMethods`)
- Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² (`WithHeaders`)
- ÐºÑ€Ð¾ÑÑ-Ð´Ð¾Ð¼ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² (`ExposeHeaders`)
- Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ cookies/Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ (`AllowCredentials`)

```csharp
builder.Services.AddCors(options =>
{
    options.AddPolicy("CustomCorsPolicy", policy =>
    {
        policy.WithOrigins("http://localhost:3000")          // Ñ€Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½Ð½Ñ‹Ð¹ origin
              .WithMethods("GET", "POST")                    // Ñ€Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½Ð½Ñ‹Ðµ HTTP-Ð¼ÐµÑ‚Ð¾Ð´Ñ‹
              .WithHeaders("Content-Type", "Authorization") // Ñ€Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
              .ExposeHeaders("X-Custom-Header")              // Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸, Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñƒ
              .AllowCredentials();                           // Ñ€Ð°Ð·Ñ€ÐµÑˆÐ¸Ñ‚ÑŒ ÐºÑƒÐºÐ¸ / Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ
    });
});

app.UseCors("CustomCorsPolicy");
```

**ÐœÐµÑ‚Ð¾Ð´Ñ‹:**
- `WithOrigins(string origins)` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾Ð¼ÐµÐ½Ñ‹.
- `AllowAnyOrigin()` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ Ð»ÑŽÐ±Ñ‹Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ (âš ï¸ Ð½ÐµÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ Ñ `AllowCredentials()`).
- `WithMethods(params string[])` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ (`GET`, `POST` Ð¸ Ñ‚.Ð¿.).
- `AllowAnyMethod()` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ Ð²ÑÐµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹.
- `WithHeaders(params string[])` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸.
- `AllowAnyHeader()` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ Ð²ÑÐµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸.
- `ExposeHeaders(params string[])` â€” Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñƒ Ð²Ð¸Ð´ÐµÑ‚ÑŒ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸ Ð¾Ñ‚Ð²ÐµÑ‚Ð°.
- `AllowCredentials()` â€” Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ cookies, Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸ Ñ‚.Ð´.

---

### Outer links:
> Ðž Ñ‚Ð¾Ð¼ ÐºÐ°Ðº Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°Ñ‚ÑŒ JS-ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ CORS Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð½Ð° Metanit Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ:
> https://metanit.com/sharp/aspnet6/14.2.php

https://metanit.com/sharp/aspnet6/14.3.php