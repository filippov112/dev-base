#lang #lang-c_sharp 
# <font color="#00b0f0">EF Core:</font> Один к одному

  ```csharp
  public class User
  {
      public UserProfile? Profile { get; set; } // Навигационное свойство
  }

	// ключ + уникальный индекс
  public class UserProfile
  {
      public int UserId { get; set; } // Внешний ключ
      public User? User { get; set; } // Навигационное свойство
  }
  ```
---
#### **Настройка связи через Fluent API**  
  ```csharp
  protected override void OnModelCreating(ModelBuilder modelBuilder)
  {
      modelBuilder.Entity<User>()
          .HasOne(u => u.Profile)
          .WithOne(p => p.User)
          .HasForeignKey<UserProfile>(p => p.UserKey); // Указание кастомного FK
  }
  ```  

---
#### **Объединение таблиц (Table Splitting)**  
Хранение данных `User` и `UserProfile` в **одной таблице**:  
  - Данные можно запрашивать через `db.Users` и `db.UserProfiles`.  
  - Для загрузки связанных данных по-прежнему используется `Include`.  

  ```csharp
  protected override void OnModelCreating(ModelBuilder modelBuilder)
  {
      modelBuilder.Entity<User>().ToTable("Users");
      modelBuilder.Entity<UserProfile>().ToTable("Users");
  }
  ```  

  ```sql
  CREATE TABLE "Users" (
      "Id" INTEGER NOT NULL,
      "Login" TEXT,
      "Password" TEXT,
      "Name" TEXT,
      "Age" INTEGER,
      PRIMARY KEY("Id" AUTOINCREMENT)
  );
  ```  
---
### Outer links:
https://metanit.com/sharp/efcore/3.4.php