#lang #lang-c_sharp #efcore  

---
**Комплексный тип (Complex Type)** – это класс, который:  
  - Не имеет ключа (не является самостоятельной сущностью).  
  - Существует только как часть другой сущности.  
  - Может быть как значимым (`struct`), так и ссылочным (`class`) типом.  
  - Может использоваться несколькими сущностями одновременно (**разделяемость**). Изменение свойства комплексного типа **в одном месте** отражается во всех связанных сущностях **в рамках одного контекста БД**, т.е. там, где EF Core может отследить изменения без запросов к БД:   

Комплексные типы не сохраняются как отдельные таблицы. 
Их свойства добавляются в таблицы сущностей с префиксом `ИмяСвойства_`.

#### **Настройка через атрибуты** - `[ComplexType]`:

```csharp
[ComplexType]
public class Language
{
    //...
}
``` 

#### **Настройка через Fluent API** – метод `ComplexProperty()`:  
  ```csharp
  protected override void OnModelCreating(ModelBuilder modelBuilder)
  {
      modelBuilder.Entity<User>(builder => 
      {
          builder.ComplexProperty(u => u.Language);
      });
  }
  ```  

---
### Outer links:
https://metanit.com/sharp/efcore/3.12.php