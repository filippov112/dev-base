#lang #lang-c_sharp 
# <font color="#00b0f0">EF Core:</font> Массовое обновление и удаление

Для обновления или удаления данных сначала необходимо загрузить объекты в контекст.
**Недостаток**: необходимость загрузки объектов, даже если они не нужны.

`ExecuteUpdate` и `ExecuteDelete` (EF Core 7.0+) (и их асинхронные версии) позволяют обновлять/удалять данные без загрузки объектов.
Работают через `IQueryable<T>`.
- **Отсутствие синхронизации с контекстом**: Отслеживаемые сущности не обновляются автоматически после вызова `ExecuteUpdate`/`ExecuteDelete`. Требуется перезагрузка данных.

---
#### **Метод `ExecuteUpdate`**
Массовое обновление данных без загрузки сущностей.

  ```csharp
  db.Users.ExecuteUpdate(s => s.SetProperty(u => u.Age, u => u.Age + 1));
  // UPDATE [Users] SET [Age] = [Age] + 1
  ```

  ```csharp
  db.Users.Where(u => u.Name == "Tom")
           .ExecuteUpdate(s => s.SetProperty(u => u.Age, u => u.Age + 1));
  // UPDATE "Users" SET "Age" = "Age" + 1 WHERE "Name" = 'Tom'
  ```

  ```csharp
  db.Users.Where(u => u.Name == "Tom")
           .ExecuteUpdate(s => s
               .SetProperty(u => u.Age, u => u.Age + 1)
               .SetProperty(u => u.Name, u => "Tomas"));
  // UPDATE "Users" SET "Name" = 'Tomas', "Age" = "Age" + 1 WHERE "Name" = 'Tom'
  ```

---
#### **Метод `ExecuteDelete`**
Массовое удаление данных без загрузки сущностей.

  ```csharp
  db.Users.Where(u => u.Name == "Tom").ExecuteDelete();
  // DELETE FROM [Users] WHERE [Name] = 'Tom'
  ```

  ```csharp
  db.Users.ExecuteDelete();
  // DELETE FROM [Users] 
  ```

---
### Outer links:
https://metanit.com/sharp/efcore/5.11.php