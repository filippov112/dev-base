#lang #lang-c_sharp 

---
Запрос LINQ выполняется не при создании, а при **потреблении результатов** (например, при переборе в цикле, вызове `ToList()`, `ToArray()`, `Count()`).  

---
#### **`IEnumerable`**  
`IEnumerable` выполняет запрос **сразу** и фильтрует **в памяти**. 
Пространство имен - `System.Collections` / `System.Collections.Generic`  

```csharp
IEnumerable<User> userIEnum = db.Users;
var users = userIEnum.Where(p => p.Id < 10).ToList(); // Фильтрация в памяти
```  

```sql
SELECT "u"."Id", "u"."Name" FROM "Users" AS "u"
```  

---
#### **`IQueryable`**  
`IQueryable` **оптимизирует** запрос, выполняя фильтрацию **в БД**. 
Пространство имен - `System.Linq`
Позволяет динамически наращивать условия.  

```csharp
IQueryable<User> userIQuer = db.Users;
var users = userIQuer.Where(p => p.Id < 10).ToList(); // Фильтрация в SQL
```  

```sql
SELECT "u"."Id", "u"."Name" FROM "Users" AS "u" WHERE "u"."Id" < 10
```  

```csharp
IQueryable<User> query = db.Users;
query = query.Where(p => p.Id < 10);
query = query.Where(p => p.Name == "Tom");
var users = query.ToList();
```  

```sql
SELECT "u"."Id", "u"."Name" FROM "Users" AS "u" 
WHERE ("u"."Id" < 10) AND ("u"."Name" = 'Tom')
```  
---
### Outer links:
https://metanit.com/sharp/efcore/5.6.php