#lang #lang-c_sharp 
# <font color="#00b0f0">EF Core:</font> Выборка и фильтрация

---
#### **Фильтрация с помощью `Where`**
- **Метод `Where`** - Фильтрует данные по условию.

    ```csharp
    var users = db.Users.Where(p => p.Company!.Name == "Google");
    ```

    ```csharp
    var users = from user in db.Users
                where user.Company!.Name == "Google"
                select user;
    ```

---
#### **Поиск по шаблону с `EF.Functions.Like`**
- **Метод `Like`** - Аналог SQL-оператора `LIKE`.
  - Шаблоны:
    - `%` — любая подстрока.
    - `_` — любой одиночный символ.
    - `[a-c]` — символ из диапазона.

	```csharp
	var users = db.Users.Where(u => EF.Functions.Like(u.Age.ToString(), "2%"));
	```
	
	```csharp
	var users = db.Users.Where(p => EF.Functions.Like(p.Name!, "%Tom%"));
	```

---
#### **Выборка одного объекта**
- **Метод `Find`/`FindAsync`** - Ищет объект по первичному ключу.

    ```csharp
    User? user = db.Users.Find(3); // Поиск по Id = 3
    ```

    ```sql
    SELECT "u"."Id", "u"."Name", "u"."Age" FROM "Users" AS "u" WHERE "u"."Id" = 3 LIMIT 1
    ```

- **Методы `First`/`FirstOrDefault`** - Возвращают первый элемент выборки.
  - `FirstOrDefault` возвращает `null`, если элементов нет.
  - Асинхронные версии: `FirstOrDefaultAsync`.
    ```csharp
    User? user = db.Users.FirstOrDefault(p => p.Id == 3);
    ```

- **Другие методы**:
  - `Single`/`SingleOrDefault` — возвращают единственный элемент (бросают исключение, если элементов несколько).
  - `Last`/`LastOrDefault` — возвращают последний элемент.

---
### Outer links:
https://metanit.com/sharp/efcore/5.2.php