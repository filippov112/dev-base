#lang #lang-c_sharp 

---
`HasData()` в `OnModelCreating` (Fluent API)  - описывает начальные данные, заносимые в базу при её создании.
Удобно для тестовых данных или справочников (роли, категории). 

2 способа занесения данных в базу:
- `Database.EnsureCreated()` – создает БД и добавляет данные.  
- Миграции (`Add-Migration`, `Update-Database`) – данные включаются в SQL-скрипт.  

---
#### **`HasData()`**  
Вызывается для `Entity<T>()` в `OnModelCreating`.  
Принимает массив объектов, которые будут добавлены в таблицу.  
  - У всех объектов должен быть указан **первичный ключ**.  
  - Сначала добавляются независимые сущности, затем зависимые.  
  ```csharp
  protected override void OnModelCreating(ModelBuilder modelBuilder)
  {
      modelBuilder.Entity<User>().HasData(
          new User { Id = 1, Name = "Tom", Age = 23 },
          new User { Id = 2, Name = "Alice", Age = 26 }
      );
  }
  ```  

**Пример полного кода:**  
```csharp
public class ApplicationContext : DbContext
{
    public DbSet<User> Users { get; set; } = null!;
    public DbSet<Company> Companies { get; set; } = null!;

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Company>().HasData(
            new Company { Id = 1, Name = "Microsoft" },
            new Company { Id = 2, Name = "Google" }
        );
        modelBuilder.Entity<User>().HasData(
            new User { Id = 1, Name = "Tom", CompanyId = 1 },
            new User { Id = 2, Name = "Alice", CompanyId = 1 }
        );
    }
}
``` 

---
### Outer links:
https://metanit.com/sharp/efcore/2.14.php