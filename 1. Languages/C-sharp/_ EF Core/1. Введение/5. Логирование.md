#lang #lang-c_sharp #efcore

---
`DbContextOptionsBuilder.LogTo(Action<string>)` - встроенный в EF метод логирования операций (работает автоматически)

Настройка логов:
1. **Уровень** - `LogLevel`: `Trace`, `Debug` (по ум.), `Information`, `Warning`, `Error`, `Critical`, `None`
	```csharp
	optionsBuilder.LogTo(Console.WriteLine, LogLevel.Information);
	```

2. **Идентификатор события** (провайдеры): `SqlServerEventId`, `CoreEventId`, `RelationalEventId`
	```csharp
	optionsBuilder.LogTo(Console.WriteLine, new[] { RelationalEventId.CommandExecuted });
	```

3. **Категории** -`DbLoggerCategory`: `Database.Command`, `Database.Connection`, `Database.Transaction`, `Migration`, `Model`, `Query`, `Scaffolding` (реинжиниринг) , `Update` (`DbContext.SaveChanges()`), `Infrastructure` (остальные)
	```csharp
	optionsBuilder.LogTo(Console.WriteLine, new[] { DbLoggerCategory.Database.Command.Name });
	```

---
#### Примеры:

```csharp
// В консоль
public class ApplicationContext : DbContext
{
    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        //optionsBuilder.UseSqlite("Data Source=helloapp.db");
        optionsBuilder.LogTo(Console.WriteLine);
    }
}
```

```csharp
// В output
optionsBuilder.LogTo(message => System.Diagnostics.Debug.WriteLine(message));
```

```csharp
// В файл
public class ApplicationContext : DbContext
{
	readonly StreamWriter logStream = new StreamWriter("mylog.txt", true);
	
    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        //optionsBuilder.UseSqlite("Data Source=helloapp.db");
        optionsBuilder.LogTo(logStream.WriteLine);
    }
    public override void Dispose()
    {
        base.Dispose();
        logStream.Dispose();
    }
    public override async ValueTask DisposeAsync()
    {
        await base.DisposeAsync();
        await logStream.DisposeAsync();
    }
}

```

### Outer links:
https://metanit.com/sharp/efcore/1.6.php