#lang #lang-c_sharp 

---
**ObservableCollection** - коллекция на подобие обычного списка (**List**) с единственным отличием в виде *отслеживания изменений*.
Содержится в пространстве имен `System.Collections.ObjectModel`.
Инициализация и управление коллекцией совпадает со списками.

#### Отслеживание изменений

Определяет событие `CollectionChanged`. 
Данное событие представляет делегат `NotifyCollectionChangedEventHandler`:

```csharp
void NotifyCollectionChangedEventHandler(object? sender, NotifyCollectionChangedEventArgs e);
```

Второй параметр делегата - объект `NotifyCollectionChangedEventArgs` хранит всю *информацию о событии*. 
1. В частности, его свойство `Action` позволяет узнать характер изменений. Оно хранит одно из значений из перечисления `NotifyCollectionChangedAction`:
	- `NotifyCollectionChangedAction.Add`: добавление
	- `NotifyCollectionChangedAction.Remove`: удаление
	- `NotifyCollectionChangedAction.Replace`: замена
	- `NotifyCollectionChangedAction.Move`: перемещение объекта внутри коллекции на новую позицию
	- `NotifyCollectionChangedAction.Reset`: сброс содержимого коллекции (например, при ее очистке с помощью метода `Clear()`)

2. Свойства `NewItems` и `OldItems` позволяют получить соответственно добавленные и удаленные объекты.

```csharp
var people = new ObservableCollection<Person>() 
{ 
    new Person("Tom"), 
    new Person("Sam") 
};

// подписываемся на событие изменения коллекции
people.CollectionChanged += People_CollectionChanged;
 

// обработчик изменения коллекции
void People_CollectionChanged(object? sender, NotifyCollectionChangedEventArgs e)
{
    switch (e.Action)
    {
        case NotifyCollectionChangedAction.Add: // если добавление
            if(e.NewItems?[0] is Person newPerson)
                Console.WriteLine($"Добавлен новый объект: {newPerson.Name}");
            break;
        case NotifyCollectionChangedAction.Remove: // если удаление
            if (e.OldItems?[0] is Person oldPerson)
                Console.WriteLine($"Удален объект: {oldPerson.Name}");
            break;
        case NotifyCollectionChangedAction.Replace: // если замена
            if ((e.NewItems?[0] is Person replacingPerson)  && 
                (e.OldItems?[0] is Person replacedPerson))
                Console.WriteLine($"Объект {replacedPerson.Name} заменен объектом {replacingPerson.Name}");
            break;
    }
}
```

### Inner links:
[1. Коллекции](1.%20Languages/C-sharp/0.%20Введение/3.%20Коллекции/1.%20Коллекции.md)
[4. Списки (List)](1.%20Languages/C-sharp/0.%20Введение/3.%20Коллекции/4.%20Списки%20(List).md)

### Outer links:



