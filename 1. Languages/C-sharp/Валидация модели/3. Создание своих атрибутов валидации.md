#csharp
# <font color="#00b0f0">C#:</font> Создание своих атрибутов валидации

Для создания пользовательского атрибута необходимо:
  - Унаследовать класс от `ValidationAttribute`.
  - Переопределить метод `IsValid(object? value)`, который выполняет проверку данных.

---

#### **Атрибут уровня свойства**
Применяется к конкретному свойству модели.

```csharp
// запрещает использование имени "admin"
public class UserNameAttribute : ValidationAttribute
{
    public override bool IsValid(object? value)
    {
        if (value is string userName)
        {
            if (userName != "admin") // Если имя не равно "admin"
                return true;
            else
                ErrorMessage = "Некорректное имя: admin";
        }
        return false;
    }
}
```

```csharp
public class User
{
    [UserName]
    public string Name { get; set; }
	// ...
}
```

---

#### **Атрибут уровня класса**
Применяется ко всей модели и проверяет комбинацию свойств.

```csharp
// запрещает одновременное сочетание имени "Tom" и возраста 37.
public class UserValidationAttribute : ValidationAttribute
{
    public override bool IsValid(object? value)
    {
        if (value is User user)
        {
            if (user.Name == "Tom" && user.Age == 37)
            {
                ErrorMessage = "Имя не должно быть Tom и возраст одновременно не должен быть равен 37";
                return false;
            }
            return true;
        }
        return false;
    }
}
```

```csharp
[UserValidation]
public class User
{
    // ...
}
```


---

#### **Передача значений в атрибут через конструктор**

```csharp
public class UserValidationAttribute : ValidationAttribute
{
    public string InvalidName { get; set; }
    public int InvalidAge { get; set; }

    public UserValidationAttribute(string name, int age)
    {
        InvalidName = name;
        InvalidAge = age;
    }

    public override bool IsValid(object? value)
    // ...
}
```

```csharp
[UserValidation("Bob", 41)]
public class User
{
    // ...
}
```

---
### Outer links:
- https://metanit.com/sharp/dotnet/2.3.php