#Csharp 

# _ Рефлексия. Типы (System.Type) C#

**Рефлексия для исследования типов**: Рефлексия позволяет получить информацию о типах, методах, свойствах и других элементах *сборки* во время выполнения. Пространство имен `System.Reflection`.

### Type

**Класс `Type`** - позволяет получить информацию о любом типе, включая его методы, свойства, поля и конструкторы. `Type` предоставляет методы, такие как `GetMethods()`, `GetProperties()`, `GetFields()` и т. д.

Можно получить объект `Type` с помощью оператора `typeof`, метода `GetType()` класса `Object`, или метода `Type.GetType()`, указав имя класса с пространством имен.

**Некоторые методы и свойства:** 
- Метод `FindMembers()` возвращает массив объектов `MemberInfo` данного типа
- Метод `GetConstructors()` возвращает все конструкторы данного типа в виде набора объектов `ConstructorInfo`
- Метод `GetEvents()` возвращает все события данного типа в виде массива объектов `EventInfo`
- Метод `GetFields()` возвращает все поля данного типа в виде массива объектов `FieldInfo`
- Метод `GetInterfaces()` получает все реализуемые данным типом интерфейсы в виде массива объектов `Type`
- Метод `GetMembers()` возвращает все члены типа в виде массива объектов `MemberInfo`
- Метод `GetMethods()` получает все методы типа в виде массива объектов `MethodInfo`
- Метод `GetProperties()` получает все свойства в виде массива объектов `PropertyInfo`
- Свойство `Name` возвращает имя типа
- Свойство `Assembly` возвращает название сборки, где определен тип
- Свойство `Namespace` возвращает название пространства имен, где определен тип
- Свойство `IsArray` возвращает `true`, если тип является массивом
- Свойство `IsClass` возвращает `true`, если тип представляет класс
- Свойство `IsEnum` возвращает `true`, если тип является перечислением
- Свойство `IsInterface` возвращает `true`, если тип представляет интерфейс

---

### Примеры кода:

1. **Получение типа через оператор `typeof`** — используется для получения объекта `Type` без создания экземпляра класса:
    ```csharp
    Type myType = typeof(Person);
    Console.WriteLine(myType);  // Person

    public class Person
    {
        public string Name { get; }
        public Person(string name) => Name = name;
    }
    ```
 
2. **Получение типа с помощью метода `GetType()` класса Object**:
    ```csharp
    Person tom = new Person("Tom");
    Type myType = tom.GetType();
    ```
 
3. **Получение типа с использованием статического метода `Type.GetType()`** — позволяет указать имя класса с пространством имен:
    ```csharp
    Type? myType = Type.GetType("PeopleTypes.Person", false, true);
    Console.WriteLine(myType);  // PeopleTypes.Person

    namespace PeopleTypes
    {
        public class Person
        {
            public string Name { get; }
            public Person(string name) => Name = name;
        }
    }
    ```
 
4. **Пример использования `Type` для получения информации о типе**:
    ```csharp
    Type myType = typeof(PeopleTypes.Person);
    Console.WriteLine($"Name: {myType.Name}");
    Console.WriteLine($"Full Name: {myType.FullName}");
    Console.WriteLine($"Namespace: {myType.Namespace}");
    Console.WriteLine($"Is struct: {myType.IsValueType}");
    Console.WriteLine($"Is class: {myType.IsClass}");
    ```
   *Консольный вывод*:
   ```
   Name: Person
   Full Name: PeopleTypes.Person
   Namespace: PeopleTypes
   Is struct: False
   Is class: True
   ```
   
5. **Поиск реализованных интерфейсов с использованием метода `GetInterfaces()`** — выводит все интерфейсы, реализованные данным типом:
    ```csharp
    Type myType = typeof(Person);
    Console.WriteLine("Реализованные интерфейсы:");
    foreach (Type i in myType.GetInterfaces())
    {
        Console.WriteLine(i.Name);
    }

    public class Person : IEater, IMovable
    {
        public string Name { get; }
        public Person(string name) => Name = name;
        public void Eat() => Console.WriteLine($"{Name} eats");
        public void Move() => Console.WriteLine($"{Name} moves");
    }
    interface IEater { void Eat(); }
    interface IMovable { void Move(); }
    ```

### Outer links:
https://metanit.com/sharp/tutorial/14.1.php