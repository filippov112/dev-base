#db #sql

# Шпаргалка по работе с пересечениями таблиц в разных СУБД

## 1. Типы пересечений таблиц

#### 1.1. **INNER JOIN**
**Описание**: Возвращает только те строки, которые имеют совпадения в обеих таблицах.
```sql
SELECT columns
FROM table1
INNER JOIN table2 ON table1.column = table2.column;
```

#### 1.2. **LEFT JOIN (LEFT OUTER JOIN)**
**Описание**: Возвращает все строки из левой таблицы и совпадающие строки из правой таблицы. Если совпадений нет, возвращаются `NULL` значения из правой таблицы.
```sql
SELECT columns
FROM table1
LEFT JOIN table2 ON table1.column = table2.column;
```

#### 1.3. **RIGHT JOIN (RIGHT OUTER JOIN)**
**Описание**: Возвращает все строки из правой таблицы и совпадающие строки из левой таблицы. Если совпадений нет, возвращаются `NULL` значения из левой таблицы.
```sql
SELECT columns
FROM table1
RIGHT JOIN table2 ON table1.column = table2.column;
```

#### 1.4. **FULL JOIN (FULL OUTER JOIN)**
**Описание**: Возвращает все строки из обеих таблиц. Если совпадений нет, возвращаются `NULL` значения из той таблицы, где совпадений не найдено.
```sql
SELECT columns
FROM table1
FULL OUTER JOIN table2 ON table1.column = table2.column;
```

#### 1.5. **CROSS JOIN**
**Описание**: Возвращает декартово произведение двух таблиц, т.е. все возможные комбинации строк из обеих таблиц.
```sql
SELECT columns
FROM table1
CROSS JOIN table2;
```

#### 1.6. **INTERSECT**
**Описание**: Возвращает общие строки, найденные в обеих выборках. Не поддерживается в MySQL, но доступен в других СУБД.
```sql
SELECT columns FROM table1
INTERSECT
SELECT columns FROM table2;
```

---

## 2. Примеры использования пересечений в разных СУБД

### 2.1. **INNER JOIN**

```sql
SELECT e.Name, d.DepartmentName
FROM Employees e
INNER JOIN Departments d ON e.DepartmentID = d.DepartmentID;
```

### 2.2. **LEFT JOIN**

```sql
SELECT e.Name, d.DepartmentName
FROM Employees e
LEFT JOIN Departments d ON e.DepartmentID = d.DepartmentID;
```

### 2.3. **RIGHT JOIN**

```sql
SELECT e.Name, d.DepartmentName
FROM Employees e
RIGHT JOIN Departments d ON e.DepartmentID = d.DepartmentID;
```

### 2.4. **FULL JOIN**

#### T-SQL (SQL Server), PostgreSQL:
```sql
SELECT e.Name, d.DepartmentName
FROM Employees e
FULL OUTER JOIN Departments d ON e.DepartmentID = d.DepartmentID;
```

#### MySQL:
```sql
-- MySQL не поддерживает FULL OUTER JOIN, но можно использовать UNION:
SELECT e.Name, d.DepartmentName
FROM Employees e
LEFT JOIN Departments d ON e.DepartmentID = d.DepartmentID
UNION
SELECT e.Name, d.DepartmentName
FROM Employees e
RIGHT JOIN Departments d ON e.DepartmentID = d.DepartmentID;
```

### 2.5. **CROSS JOIN**

```sql
SELECT e.Name, d.DepartmentName
FROM Employees e
CROSS JOIN Departments d;
```

### 2.6. **INTERSECT**

#### T-SQL (SQL Server), PostgreSQL:
```sql
SELECT Name FROM Employees
INTERSECT
SELECT Name FROM Managers;
```

#### MySQL:
```sql
-- MySQL не поддерживает INTERSECT, можно использовать подзапросы:
SELECT Name FROM Employees WHERE Name IN (SELECT Name FROM Managers);
```

