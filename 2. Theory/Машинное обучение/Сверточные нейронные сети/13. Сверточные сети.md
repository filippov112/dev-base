

# Сверточные слои нейронных сетей

Источник: [русская документация по сверточным слоям нейронных сетей](https://ru-keras.com/convolutional-layers/)
- [14. Реализация VGG-сетей в Keras](2.%20Theory/Машинное%20обучение/Сверточные%20нейронные%20сети/14.%20Реализация%20VGG-сетей%20в%20Keras.md)
- [15. Стилизация изображений](2.%20Theory/Машинное%20обучение/Сверточные%20нейронные%20сети/15.%20Стилизация%20изображений/15.%20Стилизация%20изображений.md)
- [16. Раскрашивание изображений через СНС](2.%20Theory/Машинное%20обучение/Сверточные%20нейронные%20сети/16.%20Раскрашивание%20изображений%20через%20СНС.md)

## Общая информация

В сверточной сети нейроны обрабатывают не все изображение сразу, когда каждому нейрону соответствует свой пиксель, как это реализовано в полносвязной НС. 

Все нейроны (фильтры) поочередно занимаются обработкой каждого пикселя и его окружения (этот элемент называется ядром фильтра). Таким образом, каждый нейрон слоя, пройдя по изображению, формирует свое изображение. (Исходное изображение размножается на число признаков, КАНАЛОВ). Получение карты признака нейроном называется СВЕРТКОЙ.

Фильтр позволяет выделять характерные участки на изображении в соответствии с конфигурацией весовых коэффициентов.

Фильтры последующих слоев обрабатывают тем же способом СРАЗУ ВСЕ каналы первого слоя (по отдельному ядру на каждый канал). Так у каждого фильтра такого слоя получается по N ядер для предыдущего слоя из N фильтров и по ядру на каждый цветовой компонент каждого признака.

---

### Padding

Padding добавляет к краям поддельные (fake) пиксели, создавая выходную матрицу того же размера, что и входная.

### Striding

Striding используется, чтобы получить выходные данные меньшего размера, чем входные (пропускает некоторые области, над которыми скользит ядро).

---

### Обработка цветных (многоканальных) изображений

1. Каждая цветовая компонента сначала преобразовывается своим ОТДЕЛЬНЫМ, независимым ядром.
2. Затем вычисленные карты признаков складываются.
3. К ним добавляется смещение и формируется единая итоговая матрица признаков.
4. Которая проходит через функцию активации нейронов.
5. И получаются выходные значения на соответствующем канале (одновременный отклик по всем цветовым каналам).

---

### Pooling (изменение масштаба)

Заключается в сверточном переборе изображения одним фильтром, выбирающим определенные значения из ядра. С помощью пулинга осуществляется масштабирование изображения по определенным признакам. Характер перебора и масштабирования можно легко настроить.

- **MaxPooling** – отбор наибольших значений.
- **MinPooling** – отбор наименьших значений.
- **AveragePooling** – отбор средних значений.

---

### Общая архитектура СНС

Пусть на вход подается изображение (чб) 32 x 32 пиксела.

1. Оно проходит через 10 каналов (нейронов) первого скрытого слоя:
    - На выходе получаем набор значений в виде тензора размерностью 32х32х10 элементов.

2. Далее применяется операция MaxPooling (2x2) для перехода на более крупный масштаб:
    - Получаем тензор 16x16x10.

3. Следующий слой имеет уже 30 различных фильтров (нейронов), каждый из которых состоит из 10 ядер (РАЗНЫХ), для обработки 10 каналов предыдущего слоя:
    - На выходе получаем тензор размерностью 16x16x30.

4. Снова выполняем операцию MaxPooling (2х2) и сокращаем размерность до 8х8х30.

Такие преобразования можно продолжать и далее, пока каждый выходной сегмент не станет размером в 1 пиксель. Или же можно остановиться на любом этапе преобразования и подать вычисленные карты признаков на вход обычной полносвязной сети.

Конечный этап СНС в задачах классификации обычно завершается полносвязной сетью, на выходе которой получаем вероятности принадлежности к тому или иному классу.


![13.1. Пример сверточной сети](2.%20Theory/Машинное%20обучение/Сверточные%20нейронные%20сети/13.1.%20Пример%20сверточной%20сети.md)