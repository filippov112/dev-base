# Пример сверточной сети

### ПОДГОТОВКА И СТАНДАРТИЗАЦИЯ ВЫБОРКИ
```python
x_train = np.expand_dims(x_train, axis=3)  # у сверточной сети должна присутствовать ось кол-ва каналов (в нашем случае 1 - ЧБ)
x_test = np.expand_dims(x_test, axis=3)    # (batch, channels, rows, cols) – если data_format = 'channels_first';
                                           # (batch, rows, cols, channels) – если data_format = 'channels_last' - по умолчанию
```

### СТРУКТУРА СЕТИ
```python
print(x_train.shape)  # отображение структуры сети

model = keras.Sequential([
    Conv2D(32, (3,3), padding='same', activation='relu', input_shape=(28, 28, 1)),  # 1ый сверточный слой (32 фильтра (нейрона), 
    MaxPooling2D((2, 2), strides=2),                                                # 3х3 размер ядра, размер изображения same (такой же), активатор, 
    Conv2D(64, (3,3), padding='same', activation='relu'),                           # формат входных значений.)

    MaxPooling2D((2, 2), strides=2),  # пулинг масштабирует изображение (2х2 сокращает размеры изображения с 14х14 до 7х7)
    Flatten(),                        # развертка
    Dense(128, activation='relu'),    # полносвязная сеть из 2 слоев для обработки всего получившегося массива данных
    Dense(10,  activation='softmax')
])
```

### КОМПИЛЯЦИЯ И ТЕСТЫ
```python
model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'])

his = model.fit(x_train, y_train_cat, batch_size=32, epochs=5, validation_split=0.2)

model.evaluate(x_test, y_test_cat)

# print(model.summary())  # вывод структуры НС в консоль
```

### СТРУКТУРА СЕТИ В ВИДЕ ТАБЛИЦЫ
```
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 28, 28, 32)        320         32 нейрона по 9+1 параметров   
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 14, 14, 32)        0           
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 64)        18496       64 нейрона по 32 нейрона по 9 связей + 1х64 bias
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 64)          0           
_________________________________________________________________
flatten (Flatten)            (None, 3136)              0           отсюда изображение обрабатывается целиком 7х7 пикселей * 64 выхода нейронов.
_________________________________________________________________
dense (Dense)                (None, 128)               401536      128 нейронов по 3136 + 1 входов 
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1290        10 нейронов по 128 + 1 нейронов пред. слоя
=================================================================
```
