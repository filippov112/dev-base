

# Реализация VGG-сетей в Keras

Пакет Keras содержит в своем составе обе сверточные сети: VGG16 и VGG19. 
Для их подключения в своем проекте нужно обратиться к соответствующим классам по ветке:
- `tf.keras.applications.VGG16` – для сети VGG16;
- `tf.keras.applications.VGG19` – для сети VGG19.

Их синтаксис схож и содержит следующие параметры:
```python
tf.keras.applications.VGG16(
    include_top=True,
    weights="imagenet",
    input_tensor=None,
    input_shape=None,
    pooling=None,
    classes=1000,
    classifier_activation="softmax",
)
```

- `include_top` – использовать ли полносвязные слои (True – да; False – нет);
- `weights` – определяет значения весов (по умолчанию берутся обученные на коллекции изображений ImageNet);
- `classes` = 1000 – число выходных нейронов;
- `classifier_activation` – функция активации для выходных нейронов.

## Пример использования

```python
# приводим к входному формату VGG-сети
img = np.array(img)
x = keras.applications.vgg16.preprocess_input(img)
print(x.shape)
x = np.expand_dims(x, axis=0)  # добавляем нулевую ось, чтобы получить формат входных данных:
                               # (batch_size, height, width, channels)
```

Здесь метод `preprocess_input` преобразовывает изображение из формата RGB в формат BGR 
(на котором обучалась сеть VGG-16) и, кроме того, 
уменьшает средние значения каждого цветового канала на величины:
- (B) 103.939
- (G) 116.779
- (R) 123.68

```python
# прогоняем через сеть
res = model.predict(x)
print(np.argmax(res))  # получаем максимальный отклик от нейрона соответствующего предмету изображения
```
