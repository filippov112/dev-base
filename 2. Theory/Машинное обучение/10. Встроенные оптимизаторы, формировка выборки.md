

# Встроенные оптимизаторы, формировка выборки

## СПОСОБЫ ОПТИМИЗАЦИИ АЛГОРИТМА ГРАД.СПУСКА

Если мы хотим дополнительно переопределять параметры оптимизатора, то следует сначала создать нужный оптимизатор, 
с помощью класса, расположенного в ветке: `keras.optimizers`.

Например:

```python
myAdam = keras.optimizers.Adam(learning_rate=0.1)
myOpt = keras.optimizers.SGD(learning_rate=0.1, momentum=0.0, nesterov=True)
```

А затем, передать ссылку на него параметру `optimizer`:

```python
model.compile(optimizer=myAdam,
             loss='categorical_crossentropy',
             metrics=['accuracy'])
```

Документация Adam-a:
- [Официальная документация на английском](https://keras.io/api/optimizers/adam/)
- [Русскоязычная документация](https://ru-keras.com/optimizer/)

В частности здесь отмечены все возможные способы оптимизации в Keras:
- **SGD**: стохастический градиентный алгоритм (с моментами, в том числе и по Нестерову);
- **RMSProp и Adadelta**: подобны Adagrad, но пытаются бороться с чрезмерным накоплением квадратов градиентов;
- **Adam**: смесь алгоритма с моментом и квадратов градиентов;
- **Adagrad**: оптимизация на основе квадратов градиентов;
- **Adamax**: вариант оптимизации по Adam, но без ограничений по норме;
- **Nadam**: комбинация алгоритма Adam с нестеровским моментом;
- **Ftrl**: оптимизатор, реализующий FTRL-алгоритм.

## ФОРМИРОВАНИЕ ВЫБОРКИ ВАЛИДАЦИИ

### 1. Автоматическая процентная

```python
model.fit(x_train, y_train_cat, batch_size=32, epochs=5, validation_split=0.2)
```

### 2. Ручная без перемешки

```python
size_val = 10000                        
x_val_split = x_train[:size_val]        
y_val_split = y_train_cat[:size_val]   
x_train_split = x_train[size_val:]    
y_train_split = y_train_cat[size_val:]
model.fit(x_train_split, y_train_split, batch_size=32, epochs=5,
          validation_data=(x_val_split, y_val_split))
```

### 3. Ручная с перемешкой

```python
from sklearn.model_selection import train_test_split
x_train_split, x_val_split, y_train_split, y_val_split = train_test_split(x_train, y_train_cat, test_size=0.2)
model.fit(x_train_split, y_train_split, batch_size=32, epochs=5,
          validation_data=(x_val_split, y_val_split))
```
