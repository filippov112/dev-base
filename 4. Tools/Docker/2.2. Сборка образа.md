#devops #Docker

# Сборка образа

> В **dockerfile** используется система слоёв (layers) — промежуточных образов для сборки итогового, например:
> ```dockerfile
> FROM alpine
> RUN apk add --no-cache bash python3
> WORKDIR /usr/app
> COPY myscript.py ./myscript.py
> ENTRYPOINT [“/bin/bash”, “-c”]
> CMD python3 ./myscript.py
> ```
> - *FROM*   — базовый (как я понял это что-то вроде самой системы, т.е. разные сборки линукса под разные задачи)
> - *RUN*  — операция, которая выполняется сразу после установки
> - *WORKDIR*  — переходы по каталогам
> - *COPY*  — пробросы файлов
> - *ENTRYPOINT*  — точка входа в контейнер через оператор `exec`
> - *CMD*  — команда запуска целевого приложения

### 1. **Создание Dockerfile**:
1. В корневом каталоге вашего проекта создайте файл с именем `Dockerfile`.
2. Определите базовый образ с помощью инструкции `FROM`. Например, для Node.js-приложения:
	```dockerfile
	FROM node:14
	```
3. Укажите рабочую директорию внутри контейнера:
	```dockerfile
	WORKDIR /app
	```
4. Скопируйте файлы проекта в контейнер:
	```dockerfile
	COPY . .
	```
5. Установите зависимости и определите команду для запуска приложения:
	```dockerfile
	RUN npm install
	CMD ["npm", "start"]
	```
	
### 2. **Сборка и проверка образа**:
1. Соберите образ с помощью команды:
	```bash
	docker build -t your-image-name .
	```
	```bash
	docker build -f Dockerfile.custom -t image_name .
	```
2. Проверьте размер созданного образа:
	```bash
	docker images
	```
3. Запустите контейнер для тестирования:
	```bash
	docker run -p 3000:3000 your-image-name
	```

#### Ссылки:
[https://docs.docker.com/get-started/overview/](https://docs.docker.com/get-started/overview/) — базовые гайды
[https://docs.docker.com/reference/](https://docs.docker.com/reference/) — рефы по отдельным частям и модулям