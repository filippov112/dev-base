#devops #FileServices 

# NFS

> Родной для unix протокол. В системе выглядит как локальный диск. Клиент-серверный
> сервер: **nfs-kernel-server**
> - поддержка за пределами unix ограничена
> - если поддерживается, то скорость выше
> - хорошо справляется в ситуациях, где много одних и тех же машин стучатся к серверу
> - не совсем понятная настройка (маунтить сетевой каталог как родной)

### Сервер
#### Развертывание NFS-сервера на Linux

**Шаг 1: Установка пакета NFS-сервера**
Начните с установки пакета nfs-kernel-server на свой Linux-сервер. 
- **Debian/Ubuntu:**
```
sudo apt install nfs-kernel-server
```

**Шаг 2: Экспорт каталогов**
Для этого отредактируйте файл `/etc/exports`. Добавьте строки, указывающие каталоги, имена хостов или IP-адреса клиентов, которым разрешен доступ, а также разрешения (чтение/запись).
```
/nfs/share 192.168.1.0/24(rw)
/nfs/data all(ro)
```
В этом примере:
- `/nfs/share` будет доступен для чтения и записи клиентам из сети 192.168.1.0/24.
- `/nfs/data` будет доступен только для чтения всем клиентам.

**Шаг 3: Сохраните изменения и перезапустите службу NFS**
```
sudo systemctl restart nfs-kernel-server
```



### Клиент
> Запрашивает доступ к файлам на сервере и монтирует их в свою файловую систему.
#### Windows: 
- *компоненты windows* -> *клиент для nfs*, дальше много-сложно в консоли (но круто), либо в сетевом окружении «*привязать сетевой диск*» или «*добавить сетевой каталог*»

#### Linux
**Настройка клиента NFS (на примере Ubuntu)**
На клиентском компьютере установите пакет nfs-common:
```
sudo apt install nfs-common
```
Создайте точку монтирования:
```
sudo mkdir /mnt/nfs_share
```
Подключите общий ресурс к точке монтирования:
```
sudo mount -t nfs 192.168.1.10:/nfs/share /mnt/nfs_share
```

В этой команде:
- `192.168.1.10` - это IP-адрес вашего NFS-сервера.
- `/nfs/share` - это общий ресурс, который вы экспортировали на шаге 2.
- `/mnt/nfs_share` - это точка монтирования, которую вы создали на шаге 4.

**Проверка работоспособности:**
Теперь вы должны иметь доступ к файлам в общем ресурсе NFS. Вы можете проверить это, перейдя в каталог `/mnt/nfs_share` и просмотрев его содержимое.

**Дополнительные ресурсы:**
- [https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu](https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu)
- [https://winitpro.ru/index.php/2020/06/05/ustanovka-nastrojka-nfs-servera-i-klienta-linux/](https://winitpro.ru/index.php/2020/06/05/ustanovka-nastrojka-nfs-servera-i-klienta-linux/)
- [https://habr.com/ru/articles/137938/](https://habr.com/ru/articles/137938/)

>[!warning]
Убедитесь, что на вашем брандмауэре открыты порты TCP и UDP, используемые NFS (по умолчанию 2049 и 2050).
Для повышения безопасности рекомендуется использовать NFSv4 с шифрованием