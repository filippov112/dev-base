#lang #lang-python #django

---
### Типы переменных-имен динамических URL

- `str` – любая не пустая строка, исключая символ ‘/’;
- `int` – любое положительное целое число, включая 0;
- `slug` – слаг, то есть, латиница ASCII таблицы, символы дефиса и подчеркивания;
- `uuid` – цифры, малые латинские символы ASCII, дефис;
- `path` – любая не пустая строка, включая символ ‘/’.

```python
urlpatterns = [path('cats/<int:catid>/', categories)]

def categories(request, catid):
    return HttpResponse(f"<h1>Статьи по категориям</h1>{catid}</p>")
```

- Можно использовать регулярные выражения через `re_path`:

```python
re_path(r'^archive/(?P<year>[0-9]{4})/', archive)
```

---

### Обработка GET и POST запросов

```python
def categories(request, cat):
    print(request.GET)  # возвращает словарь из GET-запроса если тот имел место быть
    print(request.POST) # так же и с POST-запросом
```

Например, по GET-запросу: `127.0.0.1:8000/cats/music/?name=Gagarina&type=pop`  
Мы увидим в консоли значения: `<QueryDict: {'name': ['Gagarina'], 'type': ['pop']}>`

---

### Обработка исключений при запросах к серверу

Если `DEBUG` в пакете конфигурации (файл `settings.py`) установлен как `True`, то при переходе на не существующую страницу генерируется исключение 404 с отладочной информацией.

При отключении дебагера и указании допустимых хостов (`ALLOWED_HOSTS = ['127.0.0.1']`) отладочная информация не будет отображаться.

Для кастомной обработки исключения в файле `urls.py` пакета конфигурации можно переопределить его обработчик, указав свою произвольную функцию:

```python
handler404 = pageNotFound
```

А саму функцию определим в приложении с остальными представлениями:

```python
def pageNotFound(request, exception):
    return HttpResponseNotFound('<h1>Страница не найдена</h1>')
```

Ручную генерацию исключений в представлениях можно производить следующим образом:

```python
raise Http404()
```

Примеры кодов:
- `handler500` – ошибка сервера;
- `handler403` – доступ запрещен;
- `handler400` – невозможно обработать запрос.

---

### Перенаправление через `redirect` (импортируется из `django.shortcuts`)

```python
return redirect('/')             # 302-ой временный
return redirect('/', permanent=True)  # 301-ый постоянный
```

```python
path('', index, name='home')  # можно указывать имена для представлений и обращаться по ним
return redirect('home', permanent=True)
```
