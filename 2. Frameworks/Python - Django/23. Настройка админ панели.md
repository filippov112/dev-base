#lang #lang-python #django

---
[Официальная документация](https://docs.djangoproject.com/en/3.1/)  

---

## ИСПОЛЬЗУЕМЫЕ ШАБЛОНЫ

- **admin/index.html**  
  `D:\Python\django\djsite\venv\lib\site-packages\django\contrib\admin\templates\admin\index.html`

- **admin/base_site.html**  
  `D:\Python\django\djsite\venv\lib\site-packages\django\contrib\admin\templates\admin\base_site.html`

- **admin/base.html**  
  `D:\Python\django\djsite\venv\lib\site-packages\django\contrib\admin\templates\admin\base.html`

- **admin/app_list.html**  
  `D:\Python\django\djsite\venv\lib\site-packages\django\contrib\admin\templates\admin\app_list.html`

---

Для переопределения стандартных шаблонов создадим в корневом каталоге сайта каталог **templates**, в котором создадим подкаталог **admin** для своих шаблонов админ панели.

---

## Шаги по настройке админ панели

1. Создаем шаблоны с такими же названиями: `base_site.html` (копируем содержимое).

2. Добавим каталог в список каталогов шаблонов в `settings.py`:

    ```python
    TEMPLATES = [
        {
            'DIRS': [os.path.join(BASE_DIR, 'templates')],
        },
    ]
    ```

3. Добавим в шаблон блок для подключения своих стилей оформления:

    ```html
    {% load static %}  <!-- тег для статических ссылок -->

    {% block extrastyle %}
    <link rel="stylesheet" href="{% static 'css/admin.css' %}">
    {% endblock %}
    ```

4. Сформируем каталог стилей в корневом каталоге:

    ```
    static/css
    ```

    - Создадим наш файл стилей `admin.css`, через который можем настраивать отображение элементов.

5. Через файл `admin.py` можно менять элементы панели. Например:

    ```python
    admin.site.site_title = 'Своё название страницы'
    admin.site.site_header = 'Свой заголовок'
    ```

   Полный список подобных атрибутов можно посмотреть на странице документации:  
   [Django Admin Documentation](https://docs.djangoproject.com/en/3.1/ref/contrib/admin/)

6. Добавляем отображение изображений для постов в списке. В классе отображения нужной таблицы в файле работы с админ-панелью добавим метод, возвращающий html-ссылку на изображение по текущей записи (`object`):

    ```python
    def get_html_photo(self, object):
        if object.photo:
            return mark_safe(f"<img src='{object.photo.url}' width=50>")  # функция экранирования текста
    get_html_photo.short_description = "Миниатюра"  # добавим отображаемое название поля
    ```

   Вставляем метод в список отображаемых полей таблицы:

    ```python
    list_display = ('id', 'title', 'time_create', 'get_html_photo', 'is_published')
    ```

7. В том же классе отображения таблицы в админ панели можно настроить поля редактирования на соответствующей странице записи:

    ```python
    fields = ('title', 'slug', 'cat', 'content', 'photo', 'is_published')
    ```

   Можно настраивать отображаемые поля только на чтение без возможности редактирования. Предварительно их нужно занести в список отображаемых:

    ```python
    readonly_fields = ('time_create', 'time_update', 'get_html_photo')
    ```

