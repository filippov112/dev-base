#lang #lang-c_sharp #aspnet

---
**IoC-контейнеры** (Inversion of Control) - устанавливают зависимости между абстракциями и конкретными объектами и, как правило, управляют созданием этих объектов.

**IServiceProvider** - встроенный в ASP.NET Core контейнер внедрения зависимостей.
Зависимости еще называются **сервисами**, собственно поэтому контейнер можно назвать **провайдером сервисов**. (`WebApplication.Services`)

### Колекция сервисов `IServiceCollection` 

`IServiceCollection` (`WebApplicationBuilder.Service`) - коллекция подключенных сервисов  (`ServiceDescriptor`).
- Содержит ряд сервисов по умолчанию, и также есть ряд встроенных сервисов которые можно подключить отдельно.
- Для подключения встроенных сервисов в колекцию существуют методы расширения с префиксом `Add` (можно также создавать свои для пользовательских сервисов [4. Методы расширения](1.%20Lang/C-sharp/0.%20Введение/2.%20Классовые%20механизмы/4.%20Методы%20расширения.md)). 
- Все внедрения выполняются до сборки приложения (`WebApplication`).

```csharp
WebApplicationBuilder builder = WebApplication.CreateBuilder();
IServiceCollection allServices = builder.Services;  // коллекция сервисов
```

```csharp
var builder = WebApplication.CreateBuilder();
builder.Services.AddMvc();
```

**Свойства `ServiceDescriptor`:**
- `ServiceType`: тип сервиса
- `ImplementationType`: тип реализации сервиса
- `Lifetime`: жизненный цикл сервиса


### Outer links:
https://metanit.com/sharp/aspnet6/4.1.php